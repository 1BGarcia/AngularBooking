{"ast":null,"code":"\"use strict\";\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nvar _asyncToGenerator = require(\"E:\\\\M7ProyectoAngular\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\asyncToGenerator.js\").default;\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function () {\n        return m[k];\n      }\n    };\n  }\n\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getCommonConfig = void 0;\n\nconst webpack_1 = require(\"@ngtools/webpack\");\n\nconst copy_webpack_plugin_1 = __importDefault(require(\"copy-webpack-plugin\"));\n\nconst path = __importStar(require(\"path\"));\n\nconst typescript_1 = require(\"typescript\");\n\nconst webpack_2 = require(\"webpack\");\n\nconst webpack_subresource_integrity_1 = require(\"webpack-subresource-integrity\");\n\nconst environment_options_1 = require(\"../../utils/environment-options\");\n\nconst load_esm_1 = require(\"../../utils/load-esm\");\n\nconst plugins_1 = require(\"../plugins\");\n\nconst named_chunks_plugin_1 = require(\"../plugins/named-chunks-plugin\");\n\nconst progress_plugin_1 = require(\"../plugins/progress-plugin\");\n\nconst transfer_size_plugin_1 = require(\"../plugins/transfer-size-plugin\");\n\nconst typescript_2 = require(\"../plugins/typescript\");\n\nconst helpers_1 = require(\"../utils/helpers\"); // eslint-disable-next-line max-lines-per-function\n\n\nfunction getCommonConfig(_x) {\n  return _getCommonConfig.apply(this, arguments);\n}\n\nfunction _getCommonConfig() {\n  _getCommonConfig = _asyncToGenerator(function* (wco) {\n    var _a, _b;\n\n    const {\n      root,\n      projectRoot,\n      buildOptions,\n      tsConfig,\n      projectName,\n      sourceRoot,\n      tsConfigPath,\n      scriptTarget\n    } = wco;\n    const {\n      cache,\n      codeCoverage,\n      crossOrigin = 'none',\n      platform = 'browser',\n      aot = true,\n      codeCoverageExclude = [],\n      main,\n      polyfills,\n      sourceMap: {\n        styles: stylesSourceMap,\n        scripts: scriptsSourceMap,\n        vendor: vendorSourceMap,\n        hidden: hiddenSourceMap\n      },\n      optimization: {\n        styles: stylesOptimization,\n        scripts: scriptsOptimization\n      },\n      commonChunk,\n      vendorChunk,\n      subresourceIntegrity,\n      verbose,\n      poll,\n      webWorkerTsConfig,\n      externalDependencies = [],\n      allowedCommonJsDependencies,\n      bundleDependencies\n    } = buildOptions;\n    const isPlatformServer = buildOptions.platform === 'server';\n    const extraPlugins = [];\n    const extraRules = [];\n    const entryPoints = {}; // Load ESM `@angular/compiler-cli` using the TypeScript dynamic import workaround.\n    // Once TypeScript provides support for keeping the dynamic import this workaround can be\n    // changed to a direct dynamic import.\n\n    const {\n      GLOBAL_DEFS_FOR_TERSER,\n      GLOBAL_DEFS_FOR_TERSER_WITH_AOT,\n      VERSION: NG_VERSION\n    } = yield (0, load_esm_1.loadEsmModule)('@angular/compiler-cli'); // determine hashing format\n\n    const hashFormat = (0, helpers_1.getOutputHashFormat)(buildOptions.outputHashing);\n\n    if (buildOptions.progress) {\n      extraPlugins.push(new progress_plugin_1.ProgressPlugin(platform));\n    }\n\n    if (buildOptions.main) {\n      const mainPath = path.resolve(root, buildOptions.main);\n      entryPoints['main'] = [mainPath];\n    }\n\n    if (isPlatformServer) {\n      // Fixes Critical dependency: the request of a dependency is an expression\n      extraPlugins.push(new webpack_2.ContextReplacementPlugin(/@?hapi|express[\\\\/]/));\n    }\n\n    if (!isPlatformServer) {\n      if (buildOptions.polyfills) {\n        const projectPolyfills = path.resolve(root, buildOptions.polyfills);\n\n        if (entryPoints['polyfills']) {\n          entryPoints['polyfills'].push(projectPolyfills);\n        } else {\n          entryPoints['polyfills'] = [projectPolyfills];\n        }\n      }\n\n      if (!buildOptions.aot) {\n        const jitPolyfills = require.resolve('core-js/proposals/reflect-metadata');\n\n        if (entryPoints['polyfills']) {\n          entryPoints['polyfills'].push(jitPolyfills);\n        } else {\n          entryPoints['polyfills'] = [jitPolyfills];\n        }\n      }\n    }\n\n    if (allowedCommonJsDependencies) {\n      // When this is not defined it means the builder doesn't support showing common js usages.\n      // When it does it will be an array.\n      extraPlugins.push(new plugins_1.CommonJsUsageWarnPlugin({\n        allowedDependencies: allowedCommonJsDependencies\n      }));\n    } // process global scripts\n    // Add a new asset for each entry.\n\n\n    for (const {\n      bundleName,\n      inject,\n      paths\n    } of (0, helpers_1.globalScriptsByBundleName)(root, buildOptions.scripts)) {\n      // Lazy scripts don't get a hash, otherwise they can't be loaded by name.\n      const hash = inject ? hashFormat.script : '';\n      extraPlugins.push(new plugins_1.ScriptsWebpackPlugin({\n        name: bundleName,\n        sourceMap: scriptsSourceMap,\n        scripts: paths,\n        filename: `${path.basename(bundleName)}${hash}.js`,\n        basePath: projectRoot\n      }));\n    } // process asset entries\n\n\n    if (buildOptions.assets.length) {\n      extraPlugins.push(new copy_webpack_plugin_1.default({\n        patterns: (0, helpers_1.assetPatterns)(root, buildOptions.assets)\n      }));\n    }\n\n    if (buildOptions.showCircularDependencies) {\n      const CircularDependencyPlugin = require('circular-dependency-plugin');\n\n      extraPlugins.push(new CircularDependencyPlugin({\n        exclude: /[\\\\/]node_modules[\\\\/]/\n      }));\n    }\n\n    if (buildOptions.extractLicenses) {\n      const LicenseWebpackPlugin = require('license-webpack-plugin').LicenseWebpackPlugin;\n\n      extraPlugins.push(new LicenseWebpackPlugin({\n        stats: {\n          warnings: false,\n          errors: false\n        },\n        perChunkOutput: false,\n        outputFilename: '3rdpartylicenses.txt',\n        skipChildCompilers: true\n      }));\n    }\n\n    if (scriptsSourceMap || stylesSourceMap) {\n      const include = [];\n\n      if (scriptsSourceMap) {\n        include.push(/js$/);\n      }\n\n      if (stylesSourceMap) {\n        include.push(/css$/);\n      }\n\n      extraPlugins.push(new webpack_2.SourceMapDevToolPlugin({\n        filename: '[file].map',\n        include,\n        // We want to set sourceRoot to  `webpack:///` for non\n        // inline sourcemaps as otherwise paths to sourcemaps will be broken in browser\n        // `webpack:///` is needed for Visual Studio breakpoints to work properly as currently\n        // there is no way to set the 'webRoot'\n        sourceRoot: 'webpack:///',\n        moduleFilenameTemplate: '[resource-path]',\n        append: hiddenSourceMap ? false : undefined\n      }));\n    }\n\n    if (buildOptions.statsJson) {\n      extraPlugins.push(new plugins_1.JsonStatsPlugin(path.resolve(root, buildOptions.outputPath, 'stats.json')));\n    }\n\n    if (subresourceIntegrity) {\n      extraPlugins.push(new webpack_subresource_integrity_1.SubresourceIntegrityPlugin({\n        hashFuncNames: ['sha384']\n      }));\n    }\n\n    if (scriptsSourceMap || stylesSourceMap) {\n      extraRules.push({\n        test: /\\.[cm]?jsx?$/,\n        enforce: 'pre',\n        loader: require.resolve('source-map-loader'),\n        options: {\n          filterSourceMappingUrl: (_mapUri, resourcePath) => {\n            if (vendorSourceMap) {\n              // Consume all sourcemaps when vendor option is enabled.\n              return true;\n            } // Don't consume sourcemaps in node_modules when vendor is disabled.\n            // But, do consume local libraries sourcemaps.\n\n\n            return !resourcePath.includes('node_modules');\n          }\n        }\n      });\n    }\n\n    if (main || polyfills) {\n      extraRules.push({\n        test: tsConfig.options.allowJs ? /\\.[cm]?[tj]sx?$/ : /\\.[cm]?tsx?$/,\n        loader: webpack_1.AngularWebpackLoaderPath,\n        // The below are known paths that are not part of the TypeScript compilation even when allowJs is enabled.\n        exclude: [/[\\\\/]node_modules[/\\\\](?:css-loader|mini-css-extract-plugin|webpack-dev-server|webpack)[/\\\\]/]\n      });\n      extraPlugins.push((0, typescript_2.createIvyPlugin)(wco, aot, tsConfigPath));\n    }\n\n    if (webWorkerTsConfig) {\n      extraPlugins.push((0, typescript_2.createIvyPlugin)(wco, false, path.resolve(wco.root, webWorkerTsConfig)));\n    }\n\n    const extraMinimizers = [];\n\n    if (scriptsOptimization) {\n      extraMinimizers.push(new plugins_1.JavaScriptOptimizerPlugin({\n        define: buildOptions.aot ? GLOBAL_DEFS_FOR_TERSER_WITH_AOT : GLOBAL_DEFS_FOR_TERSER,\n        sourcemap: scriptsSourceMap,\n        target: scriptTarget,\n        keepIdentifierNames: !environment_options_1.allowMangle || isPlatformServer,\n        keepNames: isPlatformServer,\n        removeLicenses: buildOptions.extractLicenses,\n        advanced: buildOptions.buildOptimizer\n      }));\n    }\n\n    if (platform === 'browser' && (scriptsOptimization || stylesOptimization.minify)) {\n      extraMinimizers.push(new transfer_size_plugin_1.TransferSizePlugin());\n    }\n\n    const externals = [...externalDependencies];\n\n    if (isPlatformServer && !bundleDependencies) {\n      externals.push(({\n        context,\n        request\n      }, callback) => (0, helpers_1.externalizePackages)(context !== null && context !== void 0 ? context : wco.projectRoot, request, callback));\n    }\n\n    let crossOriginLoading = false;\n\n    if (subresourceIntegrity && crossOrigin === 'none') {\n      crossOriginLoading = 'anonymous';\n    } else if (crossOrigin !== 'none') {\n      crossOriginLoading = crossOrigin;\n    }\n\n    return {\n      mode: scriptsOptimization || stylesOptimization.minify ? 'production' : 'development',\n      devtool: false,\n      target: [isPlatformServer ? 'node' : 'web', scriptTarget === typescript_1.ScriptTarget.ES5 ? 'es5' : 'es2015'],\n      profile: buildOptions.statsJson,\n      resolve: {\n        roots: [projectRoot],\n        extensions: ['.ts', '.tsx', '.mjs', '.js'],\n        symlinks: !buildOptions.preserveSymlinks,\n        modules: [tsConfig.options.baseUrl || projectRoot, 'node_modules'],\n        ...(0, helpers_1.getMainFieldsAndConditionNames)(scriptTarget, isPlatformServer)\n      },\n      resolveLoader: {\n        symlinks: !buildOptions.preserveSymlinks\n      },\n      context: root,\n      entry: entryPoints,\n      externals,\n      output: {\n        uniqueName: projectName,\n        hashFunction: 'xxhash64',\n        clean: (_a = buildOptions.deleteOutputPath) !== null && _a !== void 0 ? _a : true,\n        path: path.resolve(root, buildOptions.outputPath),\n        publicPath: (_b = buildOptions.deployUrl) !== null && _b !== void 0 ? _b : '',\n        filename: `[name]${hashFormat.chunk}.js`,\n        chunkFilename: `[name]${hashFormat.chunk}.js`,\n        libraryTarget: isPlatformServer ? 'commonjs' : undefined,\n        crossOriginLoading,\n        trustedTypes: 'angular#bundler',\n        scriptType: 'module'\n      },\n      watch: buildOptions.watch,\n      watchOptions: {\n        poll,\n        ignored: poll === undefined ? undefined : '**/node_modules/**'\n      },\n      performance: {\n        hints: false\n      },\n      ignoreWarnings: [// https://github.com/webpack-contrib/source-map-loader/blob/b2de4249c7431dd8432da607e08f0f65e9d64219/src/index.js#L83\n      /Failed to parse source map from/, // https://github.com/webpack-contrib/postcss-loader/blob/bd261875fdf9c596af4ffb3a1a73fe3c549befda/src/index.js#L153-L158\n      /Add postcss as project dependency/, // esbuild will issue a warning, while still hoists the @charset at the very top.\n      // This is caused by a bug in css-loader https://github.com/webpack-contrib/css-loader/issues/1212\n      /\"@charset\" must be the first rule in the file/],\n      module: {\n        // Show an error for missing exports instead of a warning.\n        strictExportPresence: true,\n        parser: {\n          javascript: {\n            // Disable auto URL asset module creation. This doesn't effect `new Worker(new URL(...))`\n            // https://webpack.js.org/guides/asset-modules/#url-assets\n            url: false,\n            worker: !!webWorkerTsConfig\n          }\n        },\n        rules: [{\n          test: /\\.?(svg|html)$/,\n          // Only process HTML and SVG which are known Angular component resources.\n          resourceQuery: /\\?ngResource/,\n          type: 'asset/source'\n        }, {\n          // Mark files inside `rxjs/add` as containing side effects.\n          // If this is fixed upstream and the fixed version becomes the minimum\n          // supported version, this can be removed.\n          test: /[/\\\\]rxjs[/\\\\]add[/\\\\].+\\.js$/,\n          sideEffects: true\n        }, {\n          test: /\\.[cm]?[tj]sx?$/,\n          // The below is needed due to a bug in `@babel/runtime`. See: https://github.com/babel/babel/issues/12824\n          resolve: {\n            fullySpecified: false\n          },\n          exclude: [/[\\\\/]node_modules[/\\\\](?:core-js|@babel|tslib|web-animations-js|web-streams-polyfill|whatwg-url)[/\\\\]/],\n          use: [{\n            loader: require.resolve('../../babel/webpack-loader'),\n            options: {\n              cacheDirectory: cache.enabled && path.join(cache.path, 'babel-webpack') || false,\n              scriptTarget,\n              aot: buildOptions.aot,\n              optimize: buildOptions.buildOptimizer,\n              instrumentCode: codeCoverage ? {\n                includedBasePath: sourceRoot,\n                excludedPaths: (0, helpers_1.getInstrumentationExcludedPaths)(root, codeCoverageExclude)\n              } : undefined\n            }\n          }]\n        }, ...extraRules]\n      },\n      experiments: {\n        backCompat: false,\n        syncWebAssembly: true,\n        asyncWebAssembly: true\n      },\n      infrastructureLogging: {\n        debug: verbose,\n        level: verbose ? 'verbose' : 'error'\n      },\n      stats: (0, helpers_1.getStatsOptions)(verbose),\n      cache: (0, helpers_1.getCacheSettings)(wco, NG_VERSION.full),\n      optimization: {\n        minimizer: extraMinimizers,\n        moduleIds: 'deterministic',\n        chunkIds: buildOptions.namedChunks ? 'named' : 'deterministic',\n        emitOnErrors: false,\n        runtimeChunk: isPlatformServer ? false : 'single',\n        splitChunks: {\n          maxAsyncRequests: Infinity,\n          cacheGroups: {\n            default: !!commonChunk && {\n              chunks: 'async',\n              minChunks: 2,\n              priority: 10\n            },\n            common: !!commonChunk && {\n              name: 'common',\n              chunks: 'async',\n              minChunks: 2,\n              enforce: true,\n              priority: 5\n            },\n            vendors: false,\n            defaultVendors: !!vendorChunk && {\n              name: 'vendor',\n              chunks: chunk => chunk.name === 'main',\n              enforce: true,\n              test: /[\\\\/]node_modules[\\\\/]/\n            }\n          }\n        }\n      },\n      plugins: [new named_chunks_plugin_1.NamedChunksPlugin(), new plugins_1.DedupeModuleResolvePlugin({\n        verbose\n      }), ...extraPlugins],\n      node: false\n    };\n  });\n  return _getCommonConfig.apply(this, arguments);\n}\n\nexports.getCommonConfig = getCommonConfig;","map":{"version":3,"sources":["E:/M7ProyectoAngular/node_modules/@angular-devkit/build-angular/src/webpack/configs/common.js"],"names":["__createBinding","Object","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__setModuleDefault","v","value","__importStar","mod","result","prototype","hasOwnProperty","call","__importDefault","exports","getCommonConfig","webpack_1","require","copy_webpack_plugin_1","path","typescript_1","webpack_2","webpack_subresource_integrity_1","environment_options_1","load_esm_1","plugins_1","named_chunks_plugin_1","progress_plugin_1","transfer_size_plugin_1","typescript_2","helpers_1","wco","_a","_b","root","projectRoot","buildOptions","tsConfig","projectName","sourceRoot","tsConfigPath","scriptTarget","cache","codeCoverage","crossOrigin","platform","aot","codeCoverageExclude","main","polyfills","sourceMap","styles","stylesSourceMap","scripts","scriptsSourceMap","vendor","vendorSourceMap","hidden","hiddenSourceMap","optimization","stylesOptimization","scriptsOptimization","commonChunk","vendorChunk","subresourceIntegrity","verbose","poll","webWorkerTsConfig","externalDependencies","allowedCommonJsDependencies","bundleDependencies","isPlatformServer","extraPlugins","extraRules","entryPoints","GLOBAL_DEFS_FOR_TERSER","GLOBAL_DEFS_FOR_TERSER_WITH_AOT","VERSION","NG_VERSION","loadEsmModule","hashFormat","getOutputHashFormat","outputHashing","progress","push","ProgressPlugin","mainPath","resolve","ContextReplacementPlugin","projectPolyfills","jitPolyfills","CommonJsUsageWarnPlugin","allowedDependencies","bundleName","inject","paths","globalScriptsByBundleName","hash","script","ScriptsWebpackPlugin","name","filename","basename","basePath","assets","length","default","patterns","assetPatterns","showCircularDependencies","CircularDependencyPlugin","exclude","extractLicenses","LicenseWebpackPlugin","stats","warnings","errors","perChunkOutput","outputFilename","skipChildCompilers","include","SourceMapDevToolPlugin","moduleFilenameTemplate","append","statsJson","JsonStatsPlugin","outputPath","SubresourceIntegrityPlugin","hashFuncNames","test","enforce","loader","options","filterSourceMappingUrl","_mapUri","resourcePath","includes","allowJs","AngularWebpackLoaderPath","createIvyPlugin","extraMinimizers","JavaScriptOptimizerPlugin","define","sourcemap","target","keepIdentifierNames","allowMangle","keepNames","removeLicenses","advanced","buildOptimizer","minify","TransferSizePlugin","externals","context","request","callback","externalizePackages","crossOriginLoading","mode","devtool","ScriptTarget","ES5","profile","roots","extensions","symlinks","preserveSymlinks","modules","baseUrl","getMainFieldsAndConditionNames","resolveLoader","entry","output","uniqueName","hashFunction","clean","deleteOutputPath","publicPath","deployUrl","chunk","chunkFilename","libraryTarget","trustedTypes","scriptType","watch","watchOptions","ignored","performance","hints","ignoreWarnings","module","strictExportPresence","parser","javascript","url","worker","rules","resourceQuery","type","sideEffects","fullySpecified","use","cacheDirectory","enabled","join","optimize","instrumentCode","includedBasePath","excludedPaths","getInstrumentationExcludedPaths","experiments","backCompat","syncWebAssembly","asyncWebAssembly","infrastructureLogging","debug","level","getStatsOptions","getCacheSettings","full","minimizer","moduleIds","chunkIds","namedChunks","emitOnErrors","runtimeChunk","splitChunks","maxAsyncRequests","Infinity","cacheGroups","chunks","minChunks","priority","common","vendors","defaultVendors","plugins","NamedChunksPlugin","DedupeModuleResolvePlugin","node"],"mappings":"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","sourcesContent":["\"use strict\";\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getCommonConfig = void 0;\nconst webpack_1 = require(\"@ngtools/webpack\");\nconst copy_webpack_plugin_1 = __importDefault(require(\"copy-webpack-plugin\"));\nconst path = __importStar(require(\"path\"));\nconst typescript_1 = require(\"typescript\");\nconst webpack_2 = require(\"webpack\");\nconst webpack_subresource_integrity_1 = require(\"webpack-subresource-integrity\");\nconst environment_options_1 = require(\"../../utils/environment-options\");\nconst load_esm_1 = require(\"../../utils/load-esm\");\nconst plugins_1 = require(\"../plugins\");\nconst named_chunks_plugin_1 = require(\"../plugins/named-chunks-plugin\");\nconst progress_plugin_1 = require(\"../plugins/progress-plugin\");\nconst transfer_size_plugin_1 = require(\"../plugins/transfer-size-plugin\");\nconst typescript_2 = require(\"../plugins/typescript\");\nconst helpers_1 = require(\"../utils/helpers\");\n// eslint-disable-next-line max-lines-per-function\nasync function getCommonConfig(wco) {\n    var _a, _b;\n    const { root, projectRoot, buildOptions, tsConfig, projectName, sourceRoot, tsConfigPath, scriptTarget, } = wco;\n    const { cache, codeCoverage, crossOrigin = 'none', platform = 'browser', aot = true, codeCoverageExclude = [], main, polyfills, sourceMap: { styles: stylesSourceMap, scripts: scriptsSourceMap, vendor: vendorSourceMap, hidden: hiddenSourceMap, }, optimization: { styles: stylesOptimization, scripts: scriptsOptimization }, commonChunk, vendorChunk, subresourceIntegrity, verbose, poll, webWorkerTsConfig, externalDependencies = [], allowedCommonJsDependencies, bundleDependencies, } = buildOptions;\n    const isPlatformServer = buildOptions.platform === 'server';\n    const extraPlugins = [];\n    const extraRules = [];\n    const entryPoints = {};\n    // Load ESM `@angular/compiler-cli` using the TypeScript dynamic import workaround.\n    // Once TypeScript provides support for keeping the dynamic import this workaround can be\n    // changed to a direct dynamic import.\n    const { GLOBAL_DEFS_FOR_TERSER, GLOBAL_DEFS_FOR_TERSER_WITH_AOT, VERSION: NG_VERSION, } = await (0, load_esm_1.loadEsmModule)('@angular/compiler-cli');\n    // determine hashing format\n    const hashFormat = (0, helpers_1.getOutputHashFormat)(buildOptions.outputHashing);\n    if (buildOptions.progress) {\n        extraPlugins.push(new progress_plugin_1.ProgressPlugin(platform));\n    }\n    if (buildOptions.main) {\n        const mainPath = path.resolve(root, buildOptions.main);\n        entryPoints['main'] = [mainPath];\n    }\n    if (isPlatformServer) {\n        // Fixes Critical dependency: the request of a dependency is an expression\n        extraPlugins.push(new webpack_2.ContextReplacementPlugin(/@?hapi|express[\\\\/]/));\n    }\n    if (!isPlatformServer) {\n        if (buildOptions.polyfills) {\n            const projectPolyfills = path.resolve(root, buildOptions.polyfills);\n            if (entryPoints['polyfills']) {\n                entryPoints['polyfills'].push(projectPolyfills);\n            }\n            else {\n                entryPoints['polyfills'] = [projectPolyfills];\n            }\n        }\n        if (!buildOptions.aot) {\n            const jitPolyfills = require.resolve('core-js/proposals/reflect-metadata');\n            if (entryPoints['polyfills']) {\n                entryPoints['polyfills'].push(jitPolyfills);\n            }\n            else {\n                entryPoints['polyfills'] = [jitPolyfills];\n            }\n        }\n    }\n    if (allowedCommonJsDependencies) {\n        // When this is not defined it means the builder doesn't support showing common js usages.\n        // When it does it will be an array.\n        extraPlugins.push(new plugins_1.CommonJsUsageWarnPlugin({\n            allowedDependencies: allowedCommonJsDependencies,\n        }));\n    }\n    // process global scripts\n    // Add a new asset for each entry.\n    for (const { bundleName, inject, paths } of (0, helpers_1.globalScriptsByBundleName)(root, buildOptions.scripts)) {\n        // Lazy scripts don't get a hash, otherwise they can't be loaded by name.\n        const hash = inject ? hashFormat.script : '';\n        extraPlugins.push(new plugins_1.ScriptsWebpackPlugin({\n            name: bundleName,\n            sourceMap: scriptsSourceMap,\n            scripts: paths,\n            filename: `${path.basename(bundleName)}${hash}.js`,\n            basePath: projectRoot,\n        }));\n    }\n    // process asset entries\n    if (buildOptions.assets.length) {\n        extraPlugins.push(new copy_webpack_plugin_1.default({\n            patterns: (0, helpers_1.assetPatterns)(root, buildOptions.assets),\n        }));\n    }\n    if (buildOptions.showCircularDependencies) {\n        const CircularDependencyPlugin = require('circular-dependency-plugin');\n        extraPlugins.push(new CircularDependencyPlugin({\n            exclude: /[\\\\/]node_modules[\\\\/]/,\n        }));\n    }\n    if (buildOptions.extractLicenses) {\n        const LicenseWebpackPlugin = require('license-webpack-plugin').LicenseWebpackPlugin;\n        extraPlugins.push(new LicenseWebpackPlugin({\n            stats: {\n                warnings: false,\n                errors: false,\n            },\n            perChunkOutput: false,\n            outputFilename: '3rdpartylicenses.txt',\n            skipChildCompilers: true,\n        }));\n    }\n    if (scriptsSourceMap || stylesSourceMap) {\n        const include = [];\n        if (scriptsSourceMap) {\n            include.push(/js$/);\n        }\n        if (stylesSourceMap) {\n            include.push(/css$/);\n        }\n        extraPlugins.push(new webpack_2.SourceMapDevToolPlugin({\n            filename: '[file].map',\n            include,\n            // We want to set sourceRoot to  `webpack:///` for non\n            // inline sourcemaps as otherwise paths to sourcemaps will be broken in browser\n            // `webpack:///` is needed for Visual Studio breakpoints to work properly as currently\n            // there is no way to set the 'webRoot'\n            sourceRoot: 'webpack:///',\n            moduleFilenameTemplate: '[resource-path]',\n            append: hiddenSourceMap ? false : undefined,\n        }));\n    }\n    if (buildOptions.statsJson) {\n        extraPlugins.push(new plugins_1.JsonStatsPlugin(path.resolve(root, buildOptions.outputPath, 'stats.json')));\n    }\n    if (subresourceIntegrity) {\n        extraPlugins.push(new webpack_subresource_integrity_1.SubresourceIntegrityPlugin({\n            hashFuncNames: ['sha384'],\n        }));\n    }\n    if (scriptsSourceMap || stylesSourceMap) {\n        extraRules.push({\n            test: /\\.[cm]?jsx?$/,\n            enforce: 'pre',\n            loader: require.resolve('source-map-loader'),\n            options: {\n                filterSourceMappingUrl: (_mapUri, resourcePath) => {\n                    if (vendorSourceMap) {\n                        // Consume all sourcemaps when vendor option is enabled.\n                        return true;\n                    }\n                    // Don't consume sourcemaps in node_modules when vendor is disabled.\n                    // But, do consume local libraries sourcemaps.\n                    return !resourcePath.includes('node_modules');\n                },\n            },\n        });\n    }\n    if (main || polyfills) {\n        extraRules.push({\n            test: tsConfig.options.allowJs ? /\\.[cm]?[tj]sx?$/ : /\\.[cm]?tsx?$/,\n            loader: webpack_1.AngularWebpackLoaderPath,\n            // The below are known paths that are not part of the TypeScript compilation even when allowJs is enabled.\n            exclude: [\n                /[\\\\/]node_modules[/\\\\](?:css-loader|mini-css-extract-plugin|webpack-dev-server|webpack)[/\\\\]/,\n            ],\n        });\n        extraPlugins.push((0, typescript_2.createIvyPlugin)(wco, aot, tsConfigPath));\n    }\n    if (webWorkerTsConfig) {\n        extraPlugins.push((0, typescript_2.createIvyPlugin)(wco, false, path.resolve(wco.root, webWorkerTsConfig)));\n    }\n    const extraMinimizers = [];\n    if (scriptsOptimization) {\n        extraMinimizers.push(new plugins_1.JavaScriptOptimizerPlugin({\n            define: buildOptions.aot ? GLOBAL_DEFS_FOR_TERSER_WITH_AOT : GLOBAL_DEFS_FOR_TERSER,\n            sourcemap: scriptsSourceMap,\n            target: scriptTarget,\n            keepIdentifierNames: !environment_options_1.allowMangle || isPlatformServer,\n            keepNames: isPlatformServer,\n            removeLicenses: buildOptions.extractLicenses,\n            advanced: buildOptions.buildOptimizer,\n        }));\n    }\n    if (platform === 'browser' && (scriptsOptimization || stylesOptimization.minify)) {\n        extraMinimizers.push(new transfer_size_plugin_1.TransferSizePlugin());\n    }\n    const externals = [...externalDependencies];\n    if (isPlatformServer && !bundleDependencies) {\n        externals.push(({ context, request }, callback) => (0, helpers_1.externalizePackages)(context !== null && context !== void 0 ? context : wco.projectRoot, request, callback));\n    }\n    let crossOriginLoading = false;\n    if (subresourceIntegrity && crossOrigin === 'none') {\n        crossOriginLoading = 'anonymous';\n    }\n    else if (crossOrigin !== 'none') {\n        crossOriginLoading = crossOrigin;\n    }\n    return {\n        mode: scriptsOptimization || stylesOptimization.minify ? 'production' : 'development',\n        devtool: false,\n        target: [\n            isPlatformServer ? 'node' : 'web',\n            scriptTarget === typescript_1.ScriptTarget.ES5 ? 'es5' : 'es2015',\n        ],\n        profile: buildOptions.statsJson,\n        resolve: {\n            roots: [projectRoot],\n            extensions: ['.ts', '.tsx', '.mjs', '.js'],\n            symlinks: !buildOptions.preserveSymlinks,\n            modules: [tsConfig.options.baseUrl || projectRoot, 'node_modules'],\n            ...(0, helpers_1.getMainFieldsAndConditionNames)(scriptTarget, isPlatformServer),\n        },\n        resolveLoader: {\n            symlinks: !buildOptions.preserveSymlinks,\n        },\n        context: root,\n        entry: entryPoints,\n        externals,\n        output: {\n            uniqueName: projectName,\n            hashFunction: 'xxhash64',\n            clean: (_a = buildOptions.deleteOutputPath) !== null && _a !== void 0 ? _a : true,\n            path: path.resolve(root, buildOptions.outputPath),\n            publicPath: (_b = buildOptions.deployUrl) !== null && _b !== void 0 ? _b : '',\n            filename: `[name]${hashFormat.chunk}.js`,\n            chunkFilename: `[name]${hashFormat.chunk}.js`,\n            libraryTarget: isPlatformServer ? 'commonjs' : undefined,\n            crossOriginLoading,\n            trustedTypes: 'angular#bundler',\n            scriptType: 'module',\n        },\n        watch: buildOptions.watch,\n        watchOptions: {\n            poll,\n            ignored: poll === undefined ? undefined : '**/node_modules/**',\n        },\n        performance: {\n            hints: false,\n        },\n        ignoreWarnings: [\n            // https://github.com/webpack-contrib/source-map-loader/blob/b2de4249c7431dd8432da607e08f0f65e9d64219/src/index.js#L83\n            /Failed to parse source map from/,\n            // https://github.com/webpack-contrib/postcss-loader/blob/bd261875fdf9c596af4ffb3a1a73fe3c549befda/src/index.js#L153-L158\n            /Add postcss as project dependency/,\n            // esbuild will issue a warning, while still hoists the @charset at the very top.\n            // This is caused by a bug in css-loader https://github.com/webpack-contrib/css-loader/issues/1212\n            /\"@charset\" must be the first rule in the file/,\n        ],\n        module: {\n            // Show an error for missing exports instead of a warning.\n            strictExportPresence: true,\n            parser: {\n                javascript: {\n                    // Disable auto URL asset module creation. This doesn't effect `new Worker(new URL(...))`\n                    // https://webpack.js.org/guides/asset-modules/#url-assets\n                    url: false,\n                    worker: !!webWorkerTsConfig,\n                },\n            },\n            rules: [\n                {\n                    test: /\\.?(svg|html)$/,\n                    // Only process HTML and SVG which are known Angular component resources.\n                    resourceQuery: /\\?ngResource/,\n                    type: 'asset/source',\n                },\n                {\n                    // Mark files inside `rxjs/add` as containing side effects.\n                    // If this is fixed upstream and the fixed version becomes the minimum\n                    // supported version, this can be removed.\n                    test: /[/\\\\]rxjs[/\\\\]add[/\\\\].+\\.js$/,\n                    sideEffects: true,\n                },\n                {\n                    test: /\\.[cm]?[tj]sx?$/,\n                    // The below is needed due to a bug in `@babel/runtime`. See: https://github.com/babel/babel/issues/12824\n                    resolve: { fullySpecified: false },\n                    exclude: [\n                        /[\\\\/]node_modules[/\\\\](?:core-js|@babel|tslib|web-animations-js|web-streams-polyfill|whatwg-url)[/\\\\]/,\n                    ],\n                    use: [\n                        {\n                            loader: require.resolve('../../babel/webpack-loader'),\n                            options: {\n                                cacheDirectory: (cache.enabled && path.join(cache.path, 'babel-webpack')) || false,\n                                scriptTarget,\n                                aot: buildOptions.aot,\n                                optimize: buildOptions.buildOptimizer,\n                                instrumentCode: codeCoverage\n                                    ? {\n                                        includedBasePath: sourceRoot,\n                                        excludedPaths: (0, helpers_1.getInstrumentationExcludedPaths)(root, codeCoverageExclude),\n                                    }\n                                    : undefined,\n                            },\n                        },\n                    ],\n                },\n                ...extraRules,\n            ],\n        },\n        experiments: {\n            backCompat: false,\n            syncWebAssembly: true,\n            asyncWebAssembly: true,\n        },\n        infrastructureLogging: {\n            debug: verbose,\n            level: verbose ? 'verbose' : 'error',\n        },\n        stats: (0, helpers_1.getStatsOptions)(verbose),\n        cache: (0, helpers_1.getCacheSettings)(wco, NG_VERSION.full),\n        optimization: {\n            minimizer: extraMinimizers,\n            moduleIds: 'deterministic',\n            chunkIds: buildOptions.namedChunks ? 'named' : 'deterministic',\n            emitOnErrors: false,\n            runtimeChunk: isPlatformServer ? false : 'single',\n            splitChunks: {\n                maxAsyncRequests: Infinity,\n                cacheGroups: {\n                    default: !!commonChunk && {\n                        chunks: 'async',\n                        minChunks: 2,\n                        priority: 10,\n                    },\n                    common: !!commonChunk && {\n                        name: 'common',\n                        chunks: 'async',\n                        minChunks: 2,\n                        enforce: true,\n                        priority: 5,\n                    },\n                    vendors: false,\n                    defaultVendors: !!vendorChunk && {\n                        name: 'vendor',\n                        chunks: (chunk) => chunk.name === 'main',\n                        enforce: true,\n                        test: /[\\\\/]node_modules[\\\\/]/,\n                    },\n                },\n            },\n        },\n        plugins: [new named_chunks_plugin_1.NamedChunksPlugin(), new plugins_1.DedupeModuleResolvePlugin({ verbose }), ...extraPlugins],\n        node: false,\n    };\n}\nexports.getCommonConfig = getCommonConfig;\n"]},"metadata":{},"sourceType":"script"}