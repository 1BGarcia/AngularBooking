{"ast":null,"code":"\"use strict\";\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nvar _asyncToGenerator = require(\"E:\\\\M7ProyectoAngular\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\asyncToGenerator.js\").default;\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function () {\n        return m[k];\n      }\n    };\n  }\n\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.execute = void 0;\n\nconst architect_1 = require(\"@angular-devkit/architect\");\n\nconst build_webpack_1 = require(\"@angular-devkit/build-webpack\");\n\nconst fs = __importStar(require(\"fs\"));\n\nconst path = __importStar(require(\"path\"));\n\nconst webpack_1 = __importDefault(require(\"webpack\"));\n\nconst i18n_options_1 = require(\"../../utils/i18n-options\");\n\nconst load_esm_1 = require(\"../../utils/load-esm\");\n\nconst purge_cache_1 = require(\"../../utils/purge-cache\");\n\nconst version_1 = require(\"../../utils/version\");\n\nconst webpack_browser_config_1 = require(\"../../utils/webpack-browser-config\");\n\nconst configs_1 = require(\"../../webpack/configs\");\n\nconst stats_1 = require(\"../../webpack/utils/stats\");\n\nconst schema_1 = require(\"../browser/schema\");\n\nconst schema_2 = require(\"./schema\");\n\nfunction getI18nOutfile(format) {\n  switch (format) {\n    case 'xmb':\n      return 'messages.xmb';\n\n    case 'xlf':\n    case 'xlif':\n    case 'xliff':\n    case 'xlf2':\n    case 'xliff2':\n      return 'messages.xlf';\n\n    case 'json':\n    case 'legacy-migrate':\n      return 'messages.json';\n\n    case 'arb':\n      return 'messages.arb';\n\n    default:\n      throw new Error(`Unsupported format \"${format}\"`);\n  }\n}\n\nfunction getSerializer(_x, _x2, _x3, _x4, _x5, _x6) {\n  return _getSerializer.apply(this, arguments);\n}\n\nfunction _getSerializer() {\n  _getSerializer = _asyncToGenerator(function* (localizeToolsModule, format, sourceLocale, basePath, useLegacyIds, diagnostics) {\n    const {\n      XmbTranslationSerializer,\n      LegacyMessageIdMigrationSerializer,\n      ArbTranslationSerializer,\n      Xliff1TranslationSerializer,\n      Xliff2TranslationSerializer,\n      SimpleJsonTranslationSerializer\n    } = localizeToolsModule;\n\n    switch (format) {\n      case schema_2.Format.Xmb:\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        return new XmbTranslationSerializer(basePath, useLegacyIds);\n\n      case schema_2.Format.Xlf:\n      case schema_2.Format.Xlif:\n      case schema_2.Format.Xliff:\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        return new Xliff1TranslationSerializer(sourceLocale, basePath, useLegacyIds, {});\n\n      case schema_2.Format.Xlf2:\n      case schema_2.Format.Xliff2:\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        return new Xliff2TranslationSerializer(sourceLocale, basePath, useLegacyIds, {});\n\n      case schema_2.Format.Json:\n        return new SimpleJsonTranslationSerializer(sourceLocale);\n\n      case schema_2.Format.LegacyMigrate:\n        return new LegacyMessageIdMigrationSerializer(diagnostics);\n\n      case schema_2.Format.Arb:\n        const fileSystem = {\n          relative(from, to) {\n            return path.relative(from, to);\n          }\n\n        }; // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n        return new ArbTranslationSerializer(sourceLocale, basePath, fileSystem);\n    }\n  });\n  return _getSerializer.apply(this, arguments);\n}\n\nfunction normalizeFormatOption(options) {\n  let format = options.format;\n\n  switch (format) {\n    case schema_2.Format.Xlf:\n    case schema_2.Format.Xlif:\n    case schema_2.Format.Xliff:\n      format = schema_2.Format.Xlf;\n      break;\n\n    case schema_2.Format.Xlf2:\n    case schema_2.Format.Xliff2:\n      format = schema_2.Format.Xlf2;\n      break;\n  } // Default format is xliff1\n\n\n  return format !== null && format !== void 0 ? format : schema_2.Format.Xlf;\n}\n\nclass NoEmitPlugin {\n  apply(compiler) {\n    compiler.hooks.shouldEmit.tap('angular-no-emit', () => false);\n  }\n\n}\n/**\n * @experimental Direct usage of this function is considered experimental.\n */\n\n\nfunction execute(_x7, _x8, _x9) {\n  return _execute.apply(this, arguments);\n}\n\nfunction _execute() {\n  _execute = _asyncToGenerator(function* (options, context, transforms) {\n    var _a; // Check Angular version.\n\n\n    (0, version_1.assertCompatibleAngularVersion)(context.workspaceRoot); // Purge old build disk cache.\n\n    yield (0, purge_cache_1.purgeStaleBuildCache)(context);\n    const browserTarget = (0, architect_1.targetFromTargetString)(options.browserTarget);\n    const browserOptions = yield context.validateOptions(yield context.getTargetOptions(browserTarget), yield context.getBuilderNameForTarget(browserTarget));\n    const format = normalizeFormatOption(options); // We need to determine the outFile name so that AngularCompiler can retrieve it.\n\n    let outFile = options.outFile || getI18nOutfile(format);\n\n    if (options.outputPath) {\n      // AngularCompilerPlugin doesn't support genDir so we have to adjust outFile instead.\n      outFile = path.join(options.outputPath, outFile);\n    }\n\n    outFile = path.resolve(context.workspaceRoot, outFile);\n\n    if (!context.target || !context.target.project) {\n      throw new Error('The builder requires a target.');\n    }\n\n    try {\n      require.resolve('@angular/localize');\n    } catch {\n      return {\n        success: false,\n        error: `i18n extraction requires the '@angular/localize' package.`,\n        outputPath: outFile\n      };\n    }\n\n    const metadata = yield context.getProjectMetadata(context.target);\n    const i18n = (0, i18n_options_1.createI18nOptions)(metadata);\n    let useLegacyIds = true;\n    const ivyMessages = [];\n    const builderOptions = { ...browserOptions,\n      optimization: false,\n      sourceMap: {\n        scripts: true,\n        styles: false,\n        vendor: true\n      },\n      buildOptimizer: false,\n      aot: true,\n      progress: options.progress,\n      budgets: [],\n      assets: [],\n      scripts: [],\n      styles: [],\n      deleteOutputPath: false,\n      extractLicenses: false,\n      subresourceIntegrity: false,\n      outputHashing: schema_1.OutputHashing.None,\n      namedChunks: true,\n      allowedCommonJsDependencies: undefined\n    };\n    const {\n      config,\n      projectRoot\n    } = yield (0, webpack_browser_config_1.generateBrowserWebpackConfigFromContext)(builderOptions, context, wco => {\n      var _a; // Default value for legacy message ids is currently true\n\n\n      useLegacyIds = (_a = wco.tsConfig.options.enableI18nLegacyMessageIdFormat) !== null && _a !== void 0 ? _a : true;\n      const partials = [{\n        plugins: [new NoEmitPlugin()]\n      }, (0, configs_1.getCommonConfig)(wco)]; // Add Ivy application file extractor support\n\n      partials.unshift({\n        module: {\n          rules: [{\n            test: /\\.[cm]?[tj]sx?$/,\n            loader: require.resolve('./ivy-extract-loader'),\n            options: {\n              messageHandler: messages => ivyMessages.push(...messages)\n            }\n          }]\n        }\n      }); // Replace all stylesheets with empty content\n\n      partials.push({\n        module: {\n          rules: [{\n            test: /\\.(css|scss|sass|styl|less)$/,\n            loader: require.resolve('./empty-loader')\n          }]\n        }\n      });\n      return partials;\n    }); // All the localize usages are setup to first try the ESM entry point then fallback to the deep imports.\n    // This provides interim compatibility while the framework is transitioned to bundled ESM packages.\n\n    const localizeToolsModule = yield (0, load_esm_1.loadEsmModule)('@angular/localize/tools');\n    const webpackResult = yield (0, build_webpack_1.runWebpack)((yield (_a = transforms === null || transforms === void 0 ? void 0 : transforms.webpackConfiguration) === null || _a === void 0 ? void 0 : _a.call(transforms, config)) || config, context, {\n      logging: (0, stats_1.createWebpackLoggingCallback)(builderOptions, context.logger),\n      webpackFactory: webpack_1.default\n    }).toPromise(); // Set the outputPath to the extraction output location for downstream consumers\n\n    webpackResult.outputPath = outFile; // Complete if Webpack build failed\n\n    if (!webpackResult.success) {\n      return webpackResult;\n    }\n\n    const basePath = config.context || projectRoot;\n    const {\n      checkDuplicateMessages\n    } = localizeToolsModule; // The filesystem is used to create a relative path for each file\n    // from the basePath.  This relative path is then used in the error message.\n\n    const checkFileSystem = {\n      relative(from, to) {\n        return path.relative(from, to);\n      }\n\n    };\n    const diagnostics = checkDuplicateMessages( // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    checkFileSystem, ivyMessages, 'warning', // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    basePath);\n\n    if (diagnostics.messages.length > 0) {\n      context.logger.warn(diagnostics.formatDiagnostics(''));\n    } // Serialize all extracted messages\n\n\n    const serializer = yield getSerializer(localizeToolsModule, format, i18n.sourceLocale, basePath, useLegacyIds, diagnostics);\n    const content = serializer.serialize(ivyMessages); // Ensure directory exists\n\n    const outputPath = path.dirname(outFile);\n\n    if (!fs.existsSync(outputPath)) {\n      fs.mkdirSync(outputPath, {\n        recursive: true\n      });\n    } // Write translation file\n\n\n    fs.writeFileSync(outFile, content);\n    return webpackResult;\n  });\n  return _execute.apply(this, arguments);\n}\n\nexports.execute = execute;\nexports.default = (0, architect_1.createBuilder)(execute);","map":{"version":3,"sources":["E:/M7ProyectoAngular/node_modules/@angular-devkit/build-angular/src/builders/extract-i18n/index.js"],"names":["__createBinding","Object","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__setModuleDefault","v","value","__importStar","mod","result","prototype","hasOwnProperty","call","__importDefault","exports","execute","architect_1","require","build_webpack_1","fs","path","webpack_1","i18n_options_1","load_esm_1","purge_cache_1","version_1","webpack_browser_config_1","configs_1","stats_1","schema_1","schema_2","getI18nOutfile","format","Error","getSerializer","localizeToolsModule","sourceLocale","basePath","useLegacyIds","diagnostics","XmbTranslationSerializer","LegacyMessageIdMigrationSerializer","ArbTranslationSerializer","Xliff1TranslationSerializer","Xliff2TranslationSerializer","SimpleJsonTranslationSerializer","Format","Xmb","Xlf","Xlif","Xliff","Xlf2","Xliff2","Json","LegacyMigrate","Arb","fileSystem","relative","from","to","normalizeFormatOption","options","NoEmitPlugin","apply","compiler","hooks","shouldEmit","tap","context","transforms","_a","assertCompatibleAngularVersion","workspaceRoot","purgeStaleBuildCache","browserTarget","targetFromTargetString","browserOptions","validateOptions","getTargetOptions","getBuilderNameForTarget","outFile","outputPath","join","resolve","target","project","success","error","metadata","getProjectMetadata","i18n","createI18nOptions","ivyMessages","builderOptions","optimization","sourceMap","scripts","styles","vendor","buildOptimizer","aot","progress","budgets","assets","deleteOutputPath","extractLicenses","subresourceIntegrity","outputHashing","OutputHashing","None","namedChunks","allowedCommonJsDependencies","config","projectRoot","generateBrowserWebpackConfigFromContext","wco","tsConfig","enableI18nLegacyMessageIdFormat","partials","plugins","getCommonConfig","unshift","module","rules","test","loader","messageHandler","messages","push","loadEsmModule","webpackResult","runWebpack","webpackConfiguration","logging","createWebpackLoggingCallback","logger","webpackFactory","default","toPromise","checkDuplicateMessages","checkFileSystem","length","warn","formatDiagnostics","serializer","content","serialize","dirname","existsSync","mkdirSync","recursive","writeFileSync","createBuilder"],"mappings":"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","sourcesContent":["\"use strict\";\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.execute = void 0;\nconst architect_1 = require(\"@angular-devkit/architect\");\nconst build_webpack_1 = require(\"@angular-devkit/build-webpack\");\nconst fs = __importStar(require(\"fs\"));\nconst path = __importStar(require(\"path\"));\nconst webpack_1 = __importDefault(require(\"webpack\"));\nconst i18n_options_1 = require(\"../../utils/i18n-options\");\nconst load_esm_1 = require(\"../../utils/load-esm\");\nconst purge_cache_1 = require(\"../../utils/purge-cache\");\nconst version_1 = require(\"../../utils/version\");\nconst webpack_browser_config_1 = require(\"../../utils/webpack-browser-config\");\nconst configs_1 = require(\"../../webpack/configs\");\nconst stats_1 = require(\"../../webpack/utils/stats\");\nconst schema_1 = require(\"../browser/schema\");\nconst schema_2 = require(\"./schema\");\nfunction getI18nOutfile(format) {\n    switch (format) {\n        case 'xmb':\n            return 'messages.xmb';\n        case 'xlf':\n        case 'xlif':\n        case 'xliff':\n        case 'xlf2':\n        case 'xliff2':\n            return 'messages.xlf';\n        case 'json':\n        case 'legacy-migrate':\n            return 'messages.json';\n        case 'arb':\n            return 'messages.arb';\n        default:\n            throw new Error(`Unsupported format \"${format}\"`);\n    }\n}\nasync function getSerializer(localizeToolsModule, format, sourceLocale, basePath, useLegacyIds, diagnostics) {\n    const { XmbTranslationSerializer, LegacyMessageIdMigrationSerializer, ArbTranslationSerializer, Xliff1TranslationSerializer, Xliff2TranslationSerializer, SimpleJsonTranslationSerializer, } = localizeToolsModule;\n    switch (format) {\n        case schema_2.Format.Xmb:\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return new XmbTranslationSerializer(basePath, useLegacyIds);\n        case schema_2.Format.Xlf:\n        case schema_2.Format.Xlif:\n        case schema_2.Format.Xliff:\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return new Xliff1TranslationSerializer(sourceLocale, basePath, useLegacyIds, {});\n        case schema_2.Format.Xlf2:\n        case schema_2.Format.Xliff2:\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return new Xliff2TranslationSerializer(sourceLocale, basePath, useLegacyIds, {});\n        case schema_2.Format.Json:\n            return new SimpleJsonTranslationSerializer(sourceLocale);\n        case schema_2.Format.LegacyMigrate:\n            return new LegacyMessageIdMigrationSerializer(diagnostics);\n        case schema_2.Format.Arb:\n            const fileSystem = {\n                relative(from, to) {\n                    return path.relative(from, to);\n                },\n            };\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            return new ArbTranslationSerializer(sourceLocale, basePath, fileSystem);\n    }\n}\nfunction normalizeFormatOption(options) {\n    let format = options.format;\n    switch (format) {\n        case schema_2.Format.Xlf:\n        case schema_2.Format.Xlif:\n        case schema_2.Format.Xliff:\n            format = schema_2.Format.Xlf;\n            break;\n        case schema_2.Format.Xlf2:\n        case schema_2.Format.Xliff2:\n            format = schema_2.Format.Xlf2;\n            break;\n    }\n    // Default format is xliff1\n    return format !== null && format !== void 0 ? format : schema_2.Format.Xlf;\n}\nclass NoEmitPlugin {\n    apply(compiler) {\n        compiler.hooks.shouldEmit.tap('angular-no-emit', () => false);\n    }\n}\n/**\n * @experimental Direct usage of this function is considered experimental.\n */\nasync function execute(options, context, transforms) {\n    var _a;\n    // Check Angular version.\n    (0, version_1.assertCompatibleAngularVersion)(context.workspaceRoot);\n    // Purge old build disk cache.\n    await (0, purge_cache_1.purgeStaleBuildCache)(context);\n    const browserTarget = (0, architect_1.targetFromTargetString)(options.browserTarget);\n    const browserOptions = await context.validateOptions(await context.getTargetOptions(browserTarget), await context.getBuilderNameForTarget(browserTarget));\n    const format = normalizeFormatOption(options);\n    // We need to determine the outFile name so that AngularCompiler can retrieve it.\n    let outFile = options.outFile || getI18nOutfile(format);\n    if (options.outputPath) {\n        // AngularCompilerPlugin doesn't support genDir so we have to adjust outFile instead.\n        outFile = path.join(options.outputPath, outFile);\n    }\n    outFile = path.resolve(context.workspaceRoot, outFile);\n    if (!context.target || !context.target.project) {\n        throw new Error('The builder requires a target.');\n    }\n    try {\n        require.resolve('@angular/localize');\n    }\n    catch {\n        return {\n            success: false,\n            error: `i18n extraction requires the '@angular/localize' package.`,\n            outputPath: outFile,\n        };\n    }\n    const metadata = await context.getProjectMetadata(context.target);\n    const i18n = (0, i18n_options_1.createI18nOptions)(metadata);\n    let useLegacyIds = true;\n    const ivyMessages = [];\n    const builderOptions = {\n        ...browserOptions,\n        optimization: false,\n        sourceMap: {\n            scripts: true,\n            styles: false,\n            vendor: true,\n        },\n        buildOptimizer: false,\n        aot: true,\n        progress: options.progress,\n        budgets: [],\n        assets: [],\n        scripts: [],\n        styles: [],\n        deleteOutputPath: false,\n        extractLicenses: false,\n        subresourceIntegrity: false,\n        outputHashing: schema_1.OutputHashing.None,\n        namedChunks: true,\n        allowedCommonJsDependencies: undefined,\n    };\n    const { config, projectRoot } = await (0, webpack_browser_config_1.generateBrowserWebpackConfigFromContext)(builderOptions, context, (wco) => {\n        var _a;\n        // Default value for legacy message ids is currently true\n        useLegacyIds = (_a = wco.tsConfig.options.enableI18nLegacyMessageIdFormat) !== null && _a !== void 0 ? _a : true;\n        const partials = [\n            { plugins: [new NoEmitPlugin()] },\n            (0, configs_1.getCommonConfig)(wco),\n        ];\n        // Add Ivy application file extractor support\n        partials.unshift({\n            module: {\n                rules: [\n                    {\n                        test: /\\.[cm]?[tj]sx?$/,\n                        loader: require.resolve('./ivy-extract-loader'),\n                        options: {\n                            messageHandler: (messages) => ivyMessages.push(...messages),\n                        },\n                    },\n                ],\n            },\n        });\n        // Replace all stylesheets with empty content\n        partials.push({\n            module: {\n                rules: [\n                    {\n                        test: /\\.(css|scss|sass|styl|less)$/,\n                        loader: require.resolve('./empty-loader'),\n                    },\n                ],\n            },\n        });\n        return partials;\n    });\n    // All the localize usages are setup to first try the ESM entry point then fallback to the deep imports.\n    // This provides interim compatibility while the framework is transitioned to bundled ESM packages.\n    const localizeToolsModule = await (0, load_esm_1.loadEsmModule)('@angular/localize/tools');\n    const webpackResult = await (0, build_webpack_1.runWebpack)((await ((_a = transforms === null || transforms === void 0 ? void 0 : transforms.webpackConfiguration) === null || _a === void 0 ? void 0 : _a.call(transforms, config))) || config, context, {\n        logging: (0, stats_1.createWebpackLoggingCallback)(builderOptions, context.logger),\n        webpackFactory: webpack_1.default,\n    }).toPromise();\n    // Set the outputPath to the extraction output location for downstream consumers\n    webpackResult.outputPath = outFile;\n    // Complete if Webpack build failed\n    if (!webpackResult.success) {\n        return webpackResult;\n    }\n    const basePath = config.context || projectRoot;\n    const { checkDuplicateMessages } = localizeToolsModule;\n    // The filesystem is used to create a relative path for each file\n    // from the basePath.  This relative path is then used in the error message.\n    const checkFileSystem = {\n        relative(from, to) {\n            return path.relative(from, to);\n        },\n    };\n    const diagnostics = checkDuplicateMessages(\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    checkFileSystem, ivyMessages, 'warning', \n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    basePath);\n    if (diagnostics.messages.length > 0) {\n        context.logger.warn(diagnostics.formatDiagnostics(''));\n    }\n    // Serialize all extracted messages\n    const serializer = await getSerializer(localizeToolsModule, format, i18n.sourceLocale, basePath, useLegacyIds, diagnostics);\n    const content = serializer.serialize(ivyMessages);\n    // Ensure directory exists\n    const outputPath = path.dirname(outFile);\n    if (!fs.existsSync(outputPath)) {\n        fs.mkdirSync(outputPath, { recursive: true });\n    }\n    // Write translation file\n    fs.writeFileSync(outFile, content);\n    return webpackResult;\n}\nexports.execute = execute;\nexports.default = (0, architect_1.createBuilder)(execute);\n"]},"metadata":{},"sourceType":"script"}