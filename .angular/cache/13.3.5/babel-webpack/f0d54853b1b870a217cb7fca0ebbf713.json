{"ast":null,"code":"\"use strict\";\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nvar _asyncToGenerator = require(\"E:\\\\M7ProyectoAngular\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\asyncToGenerator.js\").default;\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function () {\n        return m[k];\n      }\n    };\n  }\n\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getIndexInputFile = exports.getIndexOutputFile = exports.generateBrowserWebpackConfigFromContext = exports.generateI18nBrowserWebpackConfigFromContext = exports.generateWebpackConfig = void 0;\n\nconst core_1 = require(\"@angular-devkit/core\");\n\nconst path = __importStar(require(\"path\"));\n\nconst typescript_1 = require(\"typescript\");\n\nconst webpack_1 = require(\"webpack\");\n\nconst webpack_merge_1 = require(\"webpack-merge\");\n\nconst utils_1 = require(\"../utils\");\n\nconst read_tsconfig_1 = require(\"../utils/read-tsconfig\");\n\nconst builder_watch_plugin_1 = require(\"../webpack/plugins/builder-watch-plugin\");\n\nconst i18n_options_1 = require(\"./i18n-options\");\n\nfunction generateWebpackConfig(_x, _x2, _x3, _x4, _x5, _x6, _x7, _x8) {\n  return _generateWebpackConfig.apply(this, arguments);\n}\n\nfunction _generateWebpackConfig() {\n  _generateWebpackConfig = _asyncToGenerator(function* (workspaceRoot, projectRoot, sourceRoot, projectName, options, webpackPartialGenerator, logger, extraBuildOptions) {\n    // Ensure Build Optimizer is only used with AOT.\n    if (options.buildOptimizer && !options.aot) {\n      throw new Error(`The 'buildOptimizer' option cannot be used without 'aot'.`);\n    }\n\n    const tsConfigPath = path.resolve(workspaceRoot, options.tsConfig);\n    const tsConfig = yield (0, read_tsconfig_1.readTsconfig)(tsConfigPath);\n    const ts = yield Promise.resolve().then(() => __importStar(require('typescript')));\n    const scriptTarget = tsConfig.options.target || ts.ScriptTarget.ES5;\n    const buildOptions = { ...options,\n      ...extraBuildOptions\n    };\n    const wco = {\n      root: workspaceRoot,\n      logger: logger.createChild('webpackConfigOptions'),\n      projectRoot,\n      sourceRoot,\n      buildOptions,\n      tsConfig,\n      tsConfigPath,\n      projectName,\n      scriptTarget\n    };\n    wco.buildOptions.progress = (0, utils_1.defaultProgress)(wco.buildOptions.progress);\n    const partials = yield Promise.all(webpackPartialGenerator(wco));\n    const webpackConfig = (0, webpack_merge_1.merge)(partials);\n    return webpackConfig;\n  });\n  return _generateWebpackConfig.apply(this, arguments);\n}\n\nexports.generateWebpackConfig = generateWebpackConfig;\n\nfunction generateI18nBrowserWebpackConfigFromContext(_x9, _x10, _x11) {\n  return _generateI18nBrowserWebpackConfigFromContext.apply(this, arguments);\n}\n\nfunction _generateI18nBrowserWebpackConfigFromContext() {\n  _generateI18nBrowserWebpackConfigFromContext = _asyncToGenerator(function* (options, context, webpackPartialGenerator, extraBuildOptions = {}) {\n    var _a;\n\n    const {\n      buildOptions,\n      i18n\n    } = yield (0, i18n_options_1.configureI18nBuild)(context, options);\n    let target = typescript_1.ScriptTarget.ES5;\n    const result = yield generateBrowserWebpackConfigFromContext(buildOptions, context, wco => {\n      target = wco.scriptTarget;\n      return webpackPartialGenerator(wco);\n    }, extraBuildOptions);\n    const config = result.config;\n\n    if (i18n.shouldInline) {\n      // Remove localize \"polyfill\" if in AOT mode\n      if (buildOptions.aot) {\n        if (!config.resolve) {\n          config.resolve = {};\n        }\n\n        if (Array.isArray(config.resolve.alias)) {\n          config.resolve.alias.push({\n            name: '@angular/localize/init',\n            alias: false\n          });\n        } else {\n          if (!config.resolve.alias) {\n            config.resolve.alias = {};\n          }\n\n          config.resolve.alias['@angular/localize/init'] = false;\n        }\n      } // Update file hashes to include translation file content\n\n\n      const i18nHash = Object.values(i18n.locales).reduce((data, locale) => data + locale.files.map(file => file.integrity || '').join('|'), '');\n      (_a = config.plugins) !== null && _a !== void 0 ? _a : config.plugins = [];\n      config.plugins.push({\n        apply(compiler) {\n          compiler.hooks.compilation.tap('build-angular', compilation => {\n            webpack_1.javascript.JavascriptModulesPlugin.getCompilationHooks(compilation).chunkHash.tap('build-angular', (_, hash) => {\n              hash.update('$localize' + i18nHash);\n            });\n          });\n        }\n\n      });\n    }\n\n    return { ...result,\n      i18n,\n      target\n    };\n  });\n  return _generateI18nBrowserWebpackConfigFromContext.apply(this, arguments);\n}\n\nexports.generateI18nBrowserWebpackConfigFromContext = generateI18nBrowserWebpackConfigFromContext;\n\nfunction generateBrowserWebpackConfigFromContext(_x12, _x13, _x14) {\n  return _generateBrowserWebpackConfigFromContext.apply(this, arguments);\n}\n\nfunction _generateBrowserWebpackConfigFromContext() {\n  _generateBrowserWebpackConfigFromContext = _asyncToGenerator(function* (options, context, webpackPartialGenerator, extraBuildOptions = {}) {\n    const projectName = context.target && context.target.project;\n\n    if (!projectName) {\n      throw new Error('The builder requires a target.');\n    }\n\n    const workspaceRoot = (0, core_1.normalize)(context.workspaceRoot);\n    const projectMetadata = yield context.getProjectMetadata(projectName);\n    const projectRoot = (0, core_1.resolve)(workspaceRoot, (0, core_1.normalize)(projectMetadata.root || ''));\n    const projectSourceRoot = projectMetadata.sourceRoot;\n    const sourceRoot = projectSourceRoot ? (0, core_1.resolve)(workspaceRoot, (0, core_1.normalize)(projectSourceRoot)) : undefined;\n    const normalizedOptions = (0, utils_1.normalizeBrowserSchema)(workspaceRoot, projectRoot, sourceRoot, options, projectMetadata);\n    const config = yield generateWebpackConfig((0, core_1.getSystemPath)(workspaceRoot), (0, core_1.getSystemPath)(projectRoot), sourceRoot && (0, core_1.getSystemPath)(sourceRoot), projectName, normalizedOptions, webpackPartialGenerator, context.logger, extraBuildOptions); // If builder watch support is present in the context, add watch plugin\n    // This is internal only and currently only used for testing\n\n    const watcherFactory = context.watcherFactory;\n\n    if (watcherFactory) {\n      if (!config.plugins) {\n        config.plugins = [];\n      }\n\n      config.plugins.push(new builder_watch_plugin_1.BuilderWatchPlugin(watcherFactory));\n    }\n\n    return {\n      config,\n      projectRoot: (0, core_1.getSystemPath)(projectRoot),\n      projectSourceRoot: sourceRoot && (0, core_1.getSystemPath)(sourceRoot)\n    };\n  });\n  return _generateBrowserWebpackConfigFromContext.apply(this, arguments);\n}\n\nexports.generateBrowserWebpackConfigFromContext = generateBrowserWebpackConfigFromContext;\n\nfunction getIndexOutputFile(index) {\n  if (typeof index === 'string') {\n    return path.basename(index);\n  } else {\n    return index.output || 'index.html';\n  }\n}\n\nexports.getIndexOutputFile = getIndexOutputFile;\n\nfunction getIndexInputFile(index) {\n  if (typeof index === 'string') {\n    return index;\n  } else {\n    return index.input;\n  }\n}\n\nexports.getIndexInputFile = getIndexInputFile;","map":{"version":3,"sources":["E:/M7ProyectoAngular/node_modules/@angular-devkit/build-angular/src/utils/webpack-browser-config.js"],"names":["__createBinding","Object","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__setModuleDefault","v","value","__importStar","mod","result","prototype","hasOwnProperty","call","exports","getIndexInputFile","getIndexOutputFile","generateBrowserWebpackConfigFromContext","generateI18nBrowserWebpackConfigFromContext","generateWebpackConfig","core_1","require","path","typescript_1","webpack_1","webpack_merge_1","utils_1","read_tsconfig_1","builder_watch_plugin_1","i18n_options_1","workspaceRoot","projectRoot","sourceRoot","projectName","options","webpackPartialGenerator","logger","extraBuildOptions","buildOptimizer","aot","Error","tsConfigPath","resolve","tsConfig","readTsconfig","ts","Promise","then","scriptTarget","target","ScriptTarget","ES5","buildOptions","wco","root","createChild","progress","defaultProgress","partials","all","webpackConfig","merge","context","_a","i18n","configureI18nBuild","config","shouldInline","Array","isArray","alias","push","name","i18nHash","values","locales","reduce","data","locale","files","map","file","integrity","join","plugins","apply","compiler","hooks","compilation","tap","javascript","JavascriptModulesPlugin","getCompilationHooks","chunkHash","_","hash","update","project","normalize","projectMetadata","getProjectMetadata","projectSourceRoot","normalizedOptions","normalizeBrowserSchema","getSystemPath","watcherFactory","BuilderWatchPlugin","index","basename","output","input"],"mappings":"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","sourcesContent":["\"use strict\";\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getIndexInputFile = exports.getIndexOutputFile = exports.generateBrowserWebpackConfigFromContext = exports.generateI18nBrowserWebpackConfigFromContext = exports.generateWebpackConfig = void 0;\nconst core_1 = require(\"@angular-devkit/core\");\nconst path = __importStar(require(\"path\"));\nconst typescript_1 = require(\"typescript\");\nconst webpack_1 = require(\"webpack\");\nconst webpack_merge_1 = require(\"webpack-merge\");\nconst utils_1 = require(\"../utils\");\nconst read_tsconfig_1 = require(\"../utils/read-tsconfig\");\nconst builder_watch_plugin_1 = require(\"../webpack/plugins/builder-watch-plugin\");\nconst i18n_options_1 = require(\"./i18n-options\");\nasync function generateWebpackConfig(workspaceRoot, projectRoot, sourceRoot, projectName, options, webpackPartialGenerator, logger, extraBuildOptions) {\n    // Ensure Build Optimizer is only used with AOT.\n    if (options.buildOptimizer && !options.aot) {\n        throw new Error(`The 'buildOptimizer' option cannot be used without 'aot'.`);\n    }\n    const tsConfigPath = path.resolve(workspaceRoot, options.tsConfig);\n    const tsConfig = await (0, read_tsconfig_1.readTsconfig)(tsConfigPath);\n    const ts = await Promise.resolve().then(() => __importStar(require('typescript')));\n    const scriptTarget = tsConfig.options.target || ts.ScriptTarget.ES5;\n    const buildOptions = { ...options, ...extraBuildOptions };\n    const wco = {\n        root: workspaceRoot,\n        logger: logger.createChild('webpackConfigOptions'),\n        projectRoot,\n        sourceRoot,\n        buildOptions,\n        tsConfig,\n        tsConfigPath,\n        projectName,\n        scriptTarget,\n    };\n    wco.buildOptions.progress = (0, utils_1.defaultProgress)(wco.buildOptions.progress);\n    const partials = await Promise.all(webpackPartialGenerator(wco));\n    const webpackConfig = (0, webpack_merge_1.merge)(partials);\n    return webpackConfig;\n}\nexports.generateWebpackConfig = generateWebpackConfig;\nasync function generateI18nBrowserWebpackConfigFromContext(options, context, webpackPartialGenerator, extraBuildOptions = {}) {\n    var _a;\n    const { buildOptions, i18n } = await (0, i18n_options_1.configureI18nBuild)(context, options);\n    let target = typescript_1.ScriptTarget.ES5;\n    const result = await generateBrowserWebpackConfigFromContext(buildOptions, context, (wco) => {\n        target = wco.scriptTarget;\n        return webpackPartialGenerator(wco);\n    }, extraBuildOptions);\n    const config = result.config;\n    if (i18n.shouldInline) {\n        // Remove localize \"polyfill\" if in AOT mode\n        if (buildOptions.aot) {\n            if (!config.resolve) {\n                config.resolve = {};\n            }\n            if (Array.isArray(config.resolve.alias)) {\n                config.resolve.alias.push({\n                    name: '@angular/localize/init',\n                    alias: false,\n                });\n            }\n            else {\n                if (!config.resolve.alias) {\n                    config.resolve.alias = {};\n                }\n                config.resolve.alias['@angular/localize/init'] = false;\n            }\n        }\n        // Update file hashes to include translation file content\n        const i18nHash = Object.values(i18n.locales).reduce((data, locale) => data + locale.files.map((file) => file.integrity || '').join('|'), '');\n        (_a = config.plugins) !== null && _a !== void 0 ? _a : (config.plugins = []);\n        config.plugins.push({\n            apply(compiler) {\n                compiler.hooks.compilation.tap('build-angular', (compilation) => {\n                    webpack_1.javascript.JavascriptModulesPlugin.getCompilationHooks(compilation).chunkHash.tap('build-angular', (_, hash) => {\n                        hash.update('$localize' + i18nHash);\n                    });\n                });\n            },\n        });\n    }\n    return { ...result, i18n, target };\n}\nexports.generateI18nBrowserWebpackConfigFromContext = generateI18nBrowserWebpackConfigFromContext;\nasync function generateBrowserWebpackConfigFromContext(options, context, webpackPartialGenerator, extraBuildOptions = {}) {\n    const projectName = context.target && context.target.project;\n    if (!projectName) {\n        throw new Error('The builder requires a target.');\n    }\n    const workspaceRoot = (0, core_1.normalize)(context.workspaceRoot);\n    const projectMetadata = await context.getProjectMetadata(projectName);\n    const projectRoot = (0, core_1.resolve)(workspaceRoot, (0, core_1.normalize)(projectMetadata.root || ''));\n    const projectSourceRoot = projectMetadata.sourceRoot;\n    const sourceRoot = projectSourceRoot\n        ? (0, core_1.resolve)(workspaceRoot, (0, core_1.normalize)(projectSourceRoot))\n        : undefined;\n    const normalizedOptions = (0, utils_1.normalizeBrowserSchema)(workspaceRoot, projectRoot, sourceRoot, options, projectMetadata);\n    const config = await generateWebpackConfig((0, core_1.getSystemPath)(workspaceRoot), (0, core_1.getSystemPath)(projectRoot), sourceRoot && (0, core_1.getSystemPath)(sourceRoot), projectName, normalizedOptions, webpackPartialGenerator, context.logger, extraBuildOptions);\n    // If builder watch support is present in the context, add watch plugin\n    // This is internal only and currently only used for testing\n    const watcherFactory = context.watcherFactory;\n    if (watcherFactory) {\n        if (!config.plugins) {\n            config.plugins = [];\n        }\n        config.plugins.push(new builder_watch_plugin_1.BuilderWatchPlugin(watcherFactory));\n    }\n    return {\n        config,\n        projectRoot: (0, core_1.getSystemPath)(projectRoot),\n        projectSourceRoot: sourceRoot && (0, core_1.getSystemPath)(sourceRoot),\n    };\n}\nexports.generateBrowserWebpackConfigFromContext = generateBrowserWebpackConfigFromContext;\nfunction getIndexOutputFile(index) {\n    if (typeof index === 'string') {\n        return path.basename(index);\n    }\n    else {\n        return index.output || 'index.html';\n    }\n}\nexports.getIndexOutputFile = getIndexOutputFile;\nfunction getIndexInputFile(index) {\n    if (typeof index === 'string') {\n        return index;\n    }\n    else {\n        return index.input;\n    }\n}\nexports.getIndexInputFile = getIndexInputFile;\n"]},"metadata":{},"sourceType":"script"}