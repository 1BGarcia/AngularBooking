{"ast":null,"code":"\"use strict\";\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nvar _asyncToGenerator = require(\"E:\\\\M7ProyectoAngular\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\asyncToGenerator.js\").default;\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.TransferSizePlugin = void 0;\n\nconst util_1 = require(\"util\");\n\nconst zlib_1 = require(\"zlib\");\n\nconst brotliCompressAsync = (0, util_1.promisify)(zlib_1.brotliCompress);\nconst PLUGIN_NAME = 'angular-transfer-size-estimator';\n\nclass TransferSizePlugin {\n  constructor() {}\n\n  apply(compiler) {\n    compiler.hooks.thisCompilation.tap(PLUGIN_NAME, compilation => {\n      compilation.hooks.processAssets.tapPromise({\n        name: PLUGIN_NAME,\n        stage: compiler.webpack.Compilation.PROCESS_ASSETS_STAGE_ANALYSE\n      }, /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator(function* (compilationAssets) {\n          const actions = [];\n\n          for (const assetName of Object.keys(compilationAssets)) {\n            if (!assetName.endsWith('.js') && !assetName.endsWith('.css')) {\n              continue;\n            }\n\n            const scriptAsset = compilation.getAsset(assetName);\n\n            if (!scriptAsset || scriptAsset.source.size() <= 0) {\n              continue;\n            }\n\n            actions.push(brotliCompressAsync(scriptAsset.source.source()).then(result => {\n              compilation.updateAsset(assetName, s => s, assetInfo => ({ ...assetInfo,\n                estimatedTransferSize: result.length\n              }));\n            }).catch(error => {\n              compilation.warnings.push(new compilation.compiler.webpack.WebpackError(`Unable to calculate estimated transfer size for '${assetName}'. Reason: ${error.message}`));\n            }));\n          }\n\n          yield Promise.all(actions);\n        });\n\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n    });\n  }\n\n}\n\nexports.TransferSizePlugin = TransferSizePlugin;","map":{"version":3,"sources":["E:/M7ProyectoAngular/node_modules/@angular-devkit/build-angular/src/webpack/plugins/transfer-size-plugin.js"],"names":["Object","defineProperty","exports","value","TransferSizePlugin","util_1","require","zlib_1","brotliCompressAsync","promisify","brotliCompress","PLUGIN_NAME","constructor","apply","compiler","hooks","thisCompilation","tap","compilation","processAssets","tapPromise","name","stage","webpack","Compilation","PROCESS_ASSETS_STAGE_ANALYSE","compilationAssets","actions","assetName","keys","endsWith","scriptAsset","getAsset","source","size","push","then","result","updateAsset","s","assetInfo","estimatedTransferSize","length","catch","error","warnings","WebpackError","message","Promise","all"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AACAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAA7C;AACAD,OAAO,CAACE,kBAAR,GAA6B,KAAK,CAAlC;;AACA,MAAMC,MAAM,GAAGC,OAAO,CAAC,MAAD,CAAtB;;AACA,MAAMC,MAAM,GAAGD,OAAO,CAAC,MAAD,CAAtB;;AACA,MAAME,mBAAmB,GAAG,CAAC,GAAGH,MAAM,CAACI,SAAX,EAAsBF,MAAM,CAACG,cAA7B,CAA5B;AACA,MAAMC,WAAW,GAAG,iCAApB;;AACA,MAAMP,kBAAN,CAAyB;AACrBQ,EAAAA,WAAW,GAAG,CAAG;;AACjBC,EAAAA,KAAK,CAACC,QAAD,EAAW;AACZA,IAAAA,QAAQ,CAACC,KAAT,CAAeC,eAAf,CAA+BC,GAA/B,CAAmCN,WAAnC,EAAiDO,WAAD,IAAiB;AAC7DA,MAAAA,WAAW,CAACH,KAAZ,CAAkBI,aAAlB,CAAgCC,UAAhC,CAA2C;AACvCC,QAAAA,IAAI,EAAEV,WADiC;AAEvCW,QAAAA,KAAK,EAAER,QAAQ,CAACS,OAAT,CAAiBC,WAAjB,CAA6BC;AAFG,OAA3C;AAAA,qCAGG,WAAOC,iBAAP,EAA6B;AAC5B,gBAAMC,OAAO,GAAG,EAAhB;;AACA,eAAK,MAAMC,SAAX,IAAwB5B,MAAM,CAAC6B,IAAP,CAAYH,iBAAZ,CAAxB,EAAwD;AACpD,gBAAI,CAACE,SAAS,CAACE,QAAV,CAAmB,KAAnB,CAAD,IAA8B,CAACF,SAAS,CAACE,QAAV,CAAmB,MAAnB,CAAnC,EAA+D;AAC3D;AACH;;AACD,kBAAMC,WAAW,GAAGb,WAAW,CAACc,QAAZ,CAAqBJ,SAArB,CAApB;;AACA,gBAAI,CAACG,WAAD,IAAgBA,WAAW,CAACE,MAAZ,CAAmBC,IAAnB,MAA6B,CAAjD,EAAoD;AAChD;AACH;;AACDP,YAAAA,OAAO,CAACQ,IAAR,CAAa3B,mBAAmB,CAACuB,WAAW,CAACE,MAAZ,CAAmBA,MAAnB,EAAD,CAAnB,CACRG,IADQ,CACFC,MAAD,IAAY;AAClBnB,cAAAA,WAAW,CAACoB,WAAZ,CAAwBV,SAAxB,EAAoCW,CAAD,IAAOA,CAA1C,EAA8CC,SAAD,KAAgB,EACzD,GAAGA,SADsD;AAEzDC,gBAAAA,qBAAqB,EAAEJ,MAAM,CAACK;AAF2B,eAAhB,CAA7C;AAIH,aANY,EAORC,KAPQ,CAODC,KAAD,IAAW;AAClB1B,cAAAA,WAAW,CAAC2B,QAAZ,CAAqBV,IAArB,CAA0B,IAAIjB,WAAW,CAACJ,QAAZ,CAAqBS,OAArB,CAA6BuB,YAAjC,CAA+C,oDAAmDlB,SAAU,cAAagB,KAAK,CAACG,OAAQ,EAAvI,CAA1B;AACH,aATY,CAAb;AAUH;;AACD,gBAAMC,OAAO,CAACC,GAAR,CAAYtB,OAAZ,CAAN;AACH,SAzBD;;AAAA;AAAA;AAAA;AAAA;AA0BH,KA3BD;AA4BH;;AA/BoB;;AAiCzBzB,OAAO,CAACE,kBAAR,GAA6BA,kBAA7B","sourcesContent":["\"use strict\";\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.TransferSizePlugin = void 0;\nconst util_1 = require(\"util\");\nconst zlib_1 = require(\"zlib\");\nconst brotliCompressAsync = (0, util_1.promisify)(zlib_1.brotliCompress);\nconst PLUGIN_NAME = 'angular-transfer-size-estimator';\nclass TransferSizePlugin {\n    constructor() { }\n    apply(compiler) {\n        compiler.hooks.thisCompilation.tap(PLUGIN_NAME, (compilation) => {\n            compilation.hooks.processAssets.tapPromise({\n                name: PLUGIN_NAME,\n                stage: compiler.webpack.Compilation.PROCESS_ASSETS_STAGE_ANALYSE,\n            }, async (compilationAssets) => {\n                const actions = [];\n                for (const assetName of Object.keys(compilationAssets)) {\n                    if (!assetName.endsWith('.js') && !assetName.endsWith('.css')) {\n                        continue;\n                    }\n                    const scriptAsset = compilation.getAsset(assetName);\n                    if (!scriptAsset || scriptAsset.source.size() <= 0) {\n                        continue;\n                    }\n                    actions.push(brotliCompressAsync(scriptAsset.source.source())\n                        .then((result) => {\n                        compilation.updateAsset(assetName, (s) => s, (assetInfo) => ({\n                            ...assetInfo,\n                            estimatedTransferSize: result.length,\n                        }));\n                    })\n                        .catch((error) => {\n                        compilation.warnings.push(new compilation.compiler.webpack.WebpackError(`Unable to calculate estimated transfer size for '${assetName}'. Reason: ${error.message}`));\n                    }));\n                }\n                await Promise.all(actions);\n            });\n        });\n    }\n}\nexports.TransferSizePlugin = TransferSizePlugin;\n"]},"metadata":{},"sourceType":"script"}