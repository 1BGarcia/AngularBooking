{"ast":null,"code":"\"use strict\";\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nvar _asyncToGenerator = require(\"E:\\\\M7ProyectoAngular\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\asyncToGenerator.js\").default;\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function () {\n        return m[k];\n      }\n    };\n  }\n\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.execute = void 0;\n\nconst architect_1 = require(\"@angular-devkit/architect\");\n\nconst build_webpack_1 = require(\"@angular-devkit/build-webpack\");\n\nconst core_1 = require(\"@angular-devkit/core\");\n\nconst path = __importStar(require(\"path\"));\n\nconst rxjs_1 = require(\"rxjs\");\n\nconst operators_1 = require(\"rxjs/operators\");\n\nconst typescript_1 = require(\"typescript\");\n\nconst utils_1 = require(\"../../utils\");\n\nconst i18n_inlining_1 = require(\"../../utils/i18n-inlining\");\n\nconst output_paths_1 = require(\"../../utils/output-paths\");\n\nconst purge_cache_1 = require(\"../../utils/purge-cache\");\n\nconst version_1 = require(\"../../utils/version\");\n\nconst webpack_browser_config_1 = require(\"../../utils/webpack-browser-config\");\n\nconst configs_1 = require(\"../../webpack/configs\");\n\nconst stats_1 = require(\"../../webpack/utils/stats\");\n/**\n * @experimental Direct usage of this function is considered experimental.\n */\n\n\nfunction execute(options, context, transforms = {}) {\n  const root = context.workspaceRoot; // Check Angular version.\n\n  (0, version_1.assertCompatibleAngularVersion)(root);\n  const baseOutputPath = path.resolve(root, options.outputPath);\n  let outputPaths;\n\n  if (typeof options.bundleDependencies === 'string') {\n    options.bundleDependencies = options.bundleDependencies === 'all';\n    context.logger.warn(`Option 'bundleDependencies' string value is deprecated since version 9. Use a boolean value instead.`);\n  }\n\n  if (!options.bundleDependencies) {\n    // eslint-disable-next-line import/no-extraneous-dependencies\n    const {\n      __processed_by_ivy_ngcc__,\n      main = ''\n    } = require('@angular/core/package.json');\n\n    if (!__processed_by_ivy_ngcc__ || !__processed_by_ivy_ngcc__.main || main.includes('__ivy_ngcc__')) {\n      context.logger.warn(core_1.tags.stripIndent`\n      Warning: Turning off 'bundleDependencies' with Ivy may result in undefined behaviour\n      unless 'node_modules' are transformed using the standalone Angular compatibility compiler (NGCC).\n      See: https://angular.io/guide/ivy#ivy-and-universal-app-shell\n    `);\n    }\n  }\n\n  return (0, rxjs_1.from)(initialize(options, context, transforms.webpackConfiguration)).pipe((0, operators_1.concatMap)(({\n    config,\n    i18n,\n    target\n  }) => {\n    return (0, build_webpack_1.runWebpack)(config, context, {\n      webpackFactory: require('webpack'),\n      logging: (stats, config) => {\n        if (options.verbose) {\n          context.logger.info(stats.toString(config.stats));\n        }\n      }\n    }).pipe((0, operators_1.concatMap)( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* (output) {\n        const {\n          emittedFiles = [],\n          outputPath,\n          webpackStats\n        } = output;\n\n        if (!webpackStats) {\n          throw new Error('Webpack stats build result is required.');\n        }\n\n        let success = output.success;\n\n        if (success && i18n.shouldInline) {\n          outputPaths = (0, output_paths_1.ensureOutputPaths)(baseOutputPath, i18n);\n          success = yield (0, i18n_inlining_1.i18nInlineEmittedFiles)(context, emittedFiles, i18n, baseOutputPath, Array.from(outputPaths.values()), [], outputPath, target <= typescript_1.ScriptTarget.ES5, options.i18nMissingTranslation);\n        }\n\n        (0, stats_1.webpackStatsLogger)(context.logger, webpackStats, config);\n        return { ...output,\n          success\n        };\n      });\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }()));\n  }), (0, operators_1.map)(output => {\n    if (!output.success) {\n      return output;\n    }\n\n    return { ...output,\n      baseOutputPath,\n      outputPath: baseOutputPath,\n      outputPaths: outputPaths || [baseOutputPath]\n    };\n  }));\n}\n\nexports.execute = execute;\nexports.default = (0, architect_1.createBuilder)(execute);\n\nfunction initialize(_x2, _x3, _x4) {\n  return _initialize.apply(this, arguments);\n}\n\nfunction _initialize() {\n  _initialize = _asyncToGenerator(function* (options, context, webpackConfigurationTransform) {\n    // Purge old build disk cache.\n    yield (0, purge_cache_1.purgeStaleBuildCache)(context);\n    const originalOutputPath = options.outputPath;\n    const {\n      config,\n      i18n,\n      target\n    } = yield (0, webpack_browser_config_1.generateI18nBrowserWebpackConfigFromContext)({ ...options,\n      buildOptimizer: false,\n      aot: true,\n      platform: 'server'\n    }, context, wco => [(0, configs_1.getCommonConfig)(wco), (0, configs_1.getStylesConfig)(wco)]);\n    let transformedConfig;\n\n    if (webpackConfigurationTransform) {\n      transformedConfig = yield webpackConfigurationTransform(config);\n    }\n\n    if (options.deleteOutputPath) {\n      (0, utils_1.deleteOutputDir)(context.workspaceRoot, originalOutputPath);\n    }\n\n    return {\n      config: transformedConfig || config,\n      i18n,\n      target\n    };\n  });\n  return _initialize.apply(this, arguments);\n}","map":{"version":3,"sources":["E:/M7ProyectoAngular/node_modules/@angular-devkit/build-angular/src/builders/server/index.js"],"names":["__createBinding","Object","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__setModuleDefault","v","value","__importStar","mod","result","prototype","hasOwnProperty","call","exports","execute","architect_1","require","build_webpack_1","core_1","path","rxjs_1","operators_1","typescript_1","utils_1","i18n_inlining_1","output_paths_1","purge_cache_1","version_1","webpack_browser_config_1","configs_1","stats_1","options","context","transforms","root","workspaceRoot","assertCompatibleAngularVersion","baseOutputPath","resolve","outputPath","outputPaths","bundleDependencies","logger","warn","__processed_by_ivy_ngcc__","main","includes","tags","stripIndent","from","initialize","webpackConfiguration","pipe","concatMap","config","i18n","target","runWebpack","webpackFactory","logging","stats","verbose","info","toString","output","emittedFiles","webpackStats","Error","success","shouldInline","ensureOutputPaths","i18nInlineEmittedFiles","Array","values","ScriptTarget","ES5","i18nMissingTranslation","webpackStatsLogger","map","default","createBuilder","webpackConfigurationTransform","purgeStaleBuildCache","originalOutputPath","generateI18nBrowserWebpackConfigFromContext","buildOptimizer","aot","platform","wco","getCommonConfig","getStylesConfig","transformedConfig","deleteOutputPath","deleteOutputDir"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AACA,IAAIA,eAAe,GAAI,QAAQ,KAAKA,eAAd,KAAmCC,MAAM,CAACC,MAAP,GAAiB,UAASC,CAAT,EAAYC,CAAZ,EAAeC,CAAf,EAAkBC,EAAlB,EAAsB;AAC5F,MAAIA,EAAE,KAAKC,SAAX,EAAsBD,EAAE,GAAGD,CAAL;AACtB,MAAIG,IAAI,GAAGP,MAAM,CAACQ,wBAAP,CAAgCL,CAAhC,EAAmCC,CAAnC,CAAX;;AACA,MAAI,CAACG,IAAD,KAAU,SAASA,IAAT,GAAgB,CAACJ,CAAC,CAACM,UAAnB,GAAgCF,IAAI,CAACG,QAAL,IAAiBH,IAAI,CAACI,YAAhE,CAAJ,EAAmF;AACjFJ,IAAAA,IAAI,GAAG;AAAEK,MAAAA,UAAU,EAAE,IAAd;AAAoBC,MAAAA,GAAG,EAAE,YAAW;AAAE,eAAOV,CAAC,CAACC,CAAD,CAAR;AAAc;AAApD,KAAP;AACD;;AACDJ,EAAAA,MAAM,CAACc,cAAP,CAAsBZ,CAAtB,EAAyBG,EAAzB,EAA6BE,IAA7B;AACH,CAPwD,GAOnD,UAASL,CAAT,EAAYC,CAAZ,EAAeC,CAAf,EAAkBC,EAAlB,EAAsB;AACxB,MAAIA,EAAE,KAAKC,SAAX,EAAsBD,EAAE,GAAGD,CAAL;AACtBF,EAAAA,CAAC,CAACG,EAAD,CAAD,GAAQF,CAAC,CAACC,CAAD,CAAT;AACH,CAVqB,CAAtB;;AAWA,IAAIW,kBAAkB,GAAI,QAAQ,KAAKA,kBAAd,KAAsCf,MAAM,CAACC,MAAP,GAAiB,UAASC,CAAT,EAAYc,CAAZ,EAAe;AAC3FhB,EAAAA,MAAM,CAACc,cAAP,CAAsBZ,CAAtB,EAAyB,SAAzB,EAAoC;AAAEU,IAAAA,UAAU,EAAE,IAAd;AAAoBK,IAAAA,KAAK,EAAED;AAA3B,GAApC;AACH,CAF8D,GAE1D,UAASd,CAAT,EAAYc,CAAZ,EAAe;AAChBd,EAAAA,CAAC,CAAC,SAAD,CAAD,GAAec,CAAf;AACH,CAJwB,CAAzB;;AAKA,IAAIE,YAAY,GAAI,QAAQ,KAAKA,YAAd,IAA+B,UAAUC,GAAV,EAAe;AAC7D,MAAIA,GAAG,IAAIA,GAAG,CAACV,UAAf,EAA2B,OAAOU,GAAP;AAC3B,MAAIC,MAAM,GAAG,EAAb;AACA,MAAID,GAAG,IAAI,IAAX,EAAiB,KAAK,IAAIf,CAAT,IAAce,GAAd,EAAmB,IAAIf,CAAC,KAAK,SAAN,IAAmBJ,MAAM,CAACqB,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCJ,GAArC,EAA0Cf,CAA1C,CAAvB,EAAqEL,eAAe,CAACqB,MAAD,EAASD,GAAT,EAAcf,CAAd,CAAf;;AACzGW,EAAAA,kBAAkB,CAACK,MAAD,EAASD,GAAT,CAAlB;;AACA,SAAOC,MAAP;AACH,CAND;;AAOApB,MAAM,CAACc,cAAP,CAAsBU,OAAtB,EAA+B,YAA/B,EAA6C;AAAEP,EAAAA,KAAK,EAAE;AAAT,CAA7C;AACAO,OAAO,CAACC,OAAR,GAAkB,KAAK,CAAvB;;AACA,MAAMC,WAAW,GAAGC,OAAO,CAAC,2BAAD,CAA3B;;AACA,MAAMC,eAAe,GAAGD,OAAO,CAAC,+BAAD,CAA/B;;AACA,MAAME,MAAM,GAAGF,OAAO,CAAC,sBAAD,CAAtB;;AACA,MAAMG,IAAI,GAAGZ,YAAY,CAACS,OAAO,CAAC,MAAD,CAAR,CAAzB;;AACA,MAAMI,MAAM,GAAGJ,OAAO,CAAC,MAAD,CAAtB;;AACA,MAAMK,WAAW,GAAGL,OAAO,CAAC,gBAAD,CAA3B;;AACA,MAAMM,YAAY,GAAGN,OAAO,CAAC,YAAD,CAA5B;;AACA,MAAMO,OAAO,GAAGP,OAAO,CAAC,aAAD,CAAvB;;AACA,MAAMQ,eAAe,GAAGR,OAAO,CAAC,2BAAD,CAA/B;;AACA,MAAMS,cAAc,GAAGT,OAAO,CAAC,0BAAD,CAA9B;;AACA,MAAMU,aAAa,GAAGV,OAAO,CAAC,yBAAD,CAA7B;;AACA,MAAMW,SAAS,GAAGX,OAAO,CAAC,qBAAD,CAAzB;;AACA,MAAMY,wBAAwB,GAAGZ,OAAO,CAAC,oCAAD,CAAxC;;AACA,MAAMa,SAAS,GAAGb,OAAO,CAAC,uBAAD,CAAzB;;AACA,MAAMc,OAAO,GAAGd,OAAO,CAAC,2BAAD,CAAvB;AACA;AACA;AACA;;;AACA,SAASF,OAAT,CAAiBiB,OAAjB,EAA0BC,OAA1B,EAAmCC,UAAU,GAAG,EAAhD,EAAoD;AAChD,QAAMC,IAAI,GAAGF,OAAO,CAACG,aAArB,CADgD,CAEhD;;AACA,GAAC,GAAGR,SAAS,CAACS,8BAAd,EAA8CF,IAA9C;AACA,QAAMG,cAAc,GAAGlB,IAAI,CAACmB,OAAL,CAAaJ,IAAb,EAAmBH,OAAO,CAACQ,UAA3B,CAAvB;AACA,MAAIC,WAAJ;;AACA,MAAI,OAAOT,OAAO,CAACU,kBAAf,KAAsC,QAA1C,EAAoD;AAChDV,IAAAA,OAAO,CAACU,kBAAR,GAA6BV,OAAO,CAACU,kBAAR,KAA+B,KAA5D;AACAT,IAAAA,OAAO,CAACU,MAAR,CAAeC,IAAf,CAAqB,sGAArB;AACH;;AACD,MAAI,CAACZ,OAAO,CAACU,kBAAb,EAAiC;AAC7B;AACA,UAAM;AAAEG,MAAAA,yBAAF;AAA6BC,MAAAA,IAAI,GAAG;AAApC,QAA2C7B,OAAO,CAAC,4BAAD,CAAxD;;AACA,QAAI,CAAC4B,yBAAD,IACA,CAACA,yBAAyB,CAACC,IAD3B,IAEAA,IAAI,CAACC,QAAL,CAAc,cAAd,CAFJ,EAEmC;AAC/Bd,MAAAA,OAAO,CAACU,MAAR,CAAeC,IAAf,CAAoBzB,MAAM,CAAC6B,IAAP,CAAYC,WAAa;AACzD;AACA;AACA;AACA,KAJY;AAKH;AACJ;;AACD,SAAO,CAAC,GAAG5B,MAAM,CAAC6B,IAAX,EAAiBC,UAAU,CAACnB,OAAD,EAAUC,OAAV,EAAmBC,UAAU,CAACkB,oBAA9B,CAA3B,EAAgFC,IAAhF,CAAqF,CAAC,GAAG/B,WAAW,CAACgC,SAAhB,EAA2B,CAAC;AAAEC,IAAAA,MAAF;AAAUC,IAAAA,IAAV;AAAgBC,IAAAA;AAAhB,GAAD,KAA8B;AACjJ,WAAO,CAAC,GAAGvC,eAAe,CAACwC,UAApB,EAAgCH,MAAhC,EAAwCtB,OAAxC,EAAiD;AACpD0B,MAAAA,cAAc,EAAE1C,OAAO,CAAC,SAAD,CAD6B;AAEpD2C,MAAAA,OAAO,EAAE,CAACC,KAAD,EAAQN,MAAR,KAAmB;AACxB,YAAIvB,OAAO,CAAC8B,OAAZ,EAAqB;AACjB7B,UAAAA,OAAO,CAACU,MAAR,CAAeoB,IAAf,CAAoBF,KAAK,CAACG,QAAN,CAAeT,MAAM,CAACM,KAAtB,CAApB;AACH;AACJ;AANmD,KAAjD,EAOJR,IAPI,CAOC,CAAC,GAAG/B,WAAW,CAACgC,SAAhB;AAAA,mCAA2B,WAAOW,MAAP,EAAkB;AACjD,cAAM;AAAEC,UAAAA,YAAY,GAAG,EAAjB;AAAqB1B,UAAAA,UAArB;AAAiC2B,UAAAA;AAAjC,YAAkDF,MAAxD;;AACA,YAAI,CAACE,YAAL,EAAmB;AACf,gBAAM,IAAIC,KAAJ,CAAU,yCAAV,CAAN;AACH;;AACD,YAAIC,OAAO,GAAGJ,MAAM,CAACI,OAArB;;AACA,YAAIA,OAAO,IAAIb,IAAI,CAACc,YAApB,EAAkC;AAC9B7B,UAAAA,WAAW,GAAG,CAAC,GAAGf,cAAc,CAAC6C,iBAAnB,EAAsCjC,cAAtC,EAAsDkB,IAAtD,CAAd;AACAa,UAAAA,OAAO,SAAS,CAAC,GAAG5C,eAAe,CAAC+C,sBAApB,EAA4CvC,OAA5C,EAAqDiC,YAArD,EAAmEV,IAAnE,EAAyElB,cAAzE,EAAyFmC,KAAK,CAACvB,IAAN,CAAWT,WAAW,CAACiC,MAAZ,EAAX,CAAzF,EAA2H,EAA3H,EAA+HlC,UAA/H,EAA2IiB,MAAM,IAAIlC,YAAY,CAACoD,YAAb,CAA0BC,GAA/K,EAAoL5C,OAAO,CAAC6C,sBAA5L,CAAhB;AACH;;AACD,SAAC,GAAG9C,OAAO,CAAC+C,kBAAZ,EAAgC7C,OAAO,CAACU,MAAxC,EAAgDwB,YAAhD,EAA8DZ,MAA9D;AACA,eAAO,EAAE,GAAGU,MAAL;AAAaI,UAAAA;AAAb,SAAP;AACH,OAZO;;AAAA;AAAA;AAAA;AAAA,QAPD,CAAP;AAoBH,GArB2F,CAArF,EAqBH,CAAC,GAAG/C,WAAW,CAACyD,GAAhB,EAAsBd,MAAD,IAAY;AACjC,QAAI,CAACA,MAAM,CAACI,OAAZ,EAAqB;AACjB,aAAOJ,MAAP;AACH;;AACD,WAAO,EACH,GAAGA,MADA;AAEH3B,MAAAA,cAFG;AAGHE,MAAAA,UAAU,EAAEF,cAHT;AAIHG,MAAAA,WAAW,EAAEA,WAAW,IAAI,CAACH,cAAD;AAJzB,KAAP;AAMH,GAVG,CArBG,CAAP;AAgCH;;AACDxB,OAAO,CAACC,OAAR,GAAkBA,OAAlB;AACAD,OAAO,CAACkE,OAAR,GAAkB,CAAC,GAAGhE,WAAW,CAACiE,aAAhB,EAA+BlE,OAA/B,CAAlB;;SACeoC,U;;;;;kCAAf,WAA0BnB,OAA1B,EAAmCC,OAAnC,EAA4CiD,6BAA5C,EAA2E;AACvE;AACA,UAAM,CAAC,GAAGvD,aAAa,CAACwD,oBAAlB,EAAwClD,OAAxC,CAAN;AACA,UAAMmD,kBAAkB,GAAGpD,OAAO,CAACQ,UAAnC;AACA,UAAM;AAAEe,MAAAA,MAAF;AAAUC,MAAAA,IAAV;AAAgBC,MAAAA;AAAhB,cAAiC,CAAC,GAAG5B,wBAAwB,CAACwD,2CAA7B,EAA0E,EAC7G,GAAGrD,OAD0G;AAE7GsD,MAAAA,cAAc,EAAE,KAF6F;AAG7GC,MAAAA,GAAG,EAAE,IAHwG;AAI7GC,MAAAA,QAAQ,EAAE;AAJmG,KAA1E,EAKpCvD,OALoC,EAK1BwD,GAAD,IAAS,CAAC,CAAC,GAAG3D,SAAS,CAAC4D,eAAd,EAA+BD,GAA/B,CAAD,EAAsC,CAAC,GAAG3D,SAAS,CAAC6D,eAAd,EAA+BF,GAA/B,CAAtC,CALkB,CAAvC;AAMA,QAAIG,iBAAJ;;AACA,QAAIV,6BAAJ,EAAmC;AAC/BU,MAAAA,iBAAiB,SAASV,6BAA6B,CAAC3B,MAAD,CAAvD;AACH;;AACD,QAAIvB,OAAO,CAAC6D,gBAAZ,EAA8B;AAC1B,OAAC,GAAGrE,OAAO,CAACsE,eAAZ,EAA6B7D,OAAO,CAACG,aAArC,EAAoDgD,kBAApD;AACH;;AACD,WAAO;AAAE7B,MAAAA,MAAM,EAAEqC,iBAAiB,IAAIrC,MAA/B;AAAuCC,MAAAA,IAAvC;AAA6CC,MAAAA;AAA7C,KAAP;AACH,G","sourcesContent":["\"use strict\";\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.execute = void 0;\nconst architect_1 = require(\"@angular-devkit/architect\");\nconst build_webpack_1 = require(\"@angular-devkit/build-webpack\");\nconst core_1 = require(\"@angular-devkit/core\");\nconst path = __importStar(require(\"path\"));\nconst rxjs_1 = require(\"rxjs\");\nconst operators_1 = require(\"rxjs/operators\");\nconst typescript_1 = require(\"typescript\");\nconst utils_1 = require(\"../../utils\");\nconst i18n_inlining_1 = require(\"../../utils/i18n-inlining\");\nconst output_paths_1 = require(\"../../utils/output-paths\");\nconst purge_cache_1 = require(\"../../utils/purge-cache\");\nconst version_1 = require(\"../../utils/version\");\nconst webpack_browser_config_1 = require(\"../../utils/webpack-browser-config\");\nconst configs_1 = require(\"../../webpack/configs\");\nconst stats_1 = require(\"../../webpack/utils/stats\");\n/**\n * @experimental Direct usage of this function is considered experimental.\n */\nfunction execute(options, context, transforms = {}) {\n    const root = context.workspaceRoot;\n    // Check Angular version.\n    (0, version_1.assertCompatibleAngularVersion)(root);\n    const baseOutputPath = path.resolve(root, options.outputPath);\n    let outputPaths;\n    if (typeof options.bundleDependencies === 'string') {\n        options.bundleDependencies = options.bundleDependencies === 'all';\n        context.logger.warn(`Option 'bundleDependencies' string value is deprecated since version 9. Use a boolean value instead.`);\n    }\n    if (!options.bundleDependencies) {\n        // eslint-disable-next-line import/no-extraneous-dependencies\n        const { __processed_by_ivy_ngcc__, main = '' } = require('@angular/core/package.json');\n        if (!__processed_by_ivy_ngcc__ ||\n            !__processed_by_ivy_ngcc__.main ||\n            main.includes('__ivy_ngcc__')) {\n            context.logger.warn(core_1.tags.stripIndent `\n      Warning: Turning off 'bundleDependencies' with Ivy may result in undefined behaviour\n      unless 'node_modules' are transformed using the standalone Angular compatibility compiler (NGCC).\n      See: https://angular.io/guide/ivy#ivy-and-universal-app-shell\n    `);\n        }\n    }\n    return (0, rxjs_1.from)(initialize(options, context, transforms.webpackConfiguration)).pipe((0, operators_1.concatMap)(({ config, i18n, target }) => {\n        return (0, build_webpack_1.runWebpack)(config, context, {\n            webpackFactory: require('webpack'),\n            logging: (stats, config) => {\n                if (options.verbose) {\n                    context.logger.info(stats.toString(config.stats));\n                }\n            },\n        }).pipe((0, operators_1.concatMap)(async (output) => {\n            const { emittedFiles = [], outputPath, webpackStats } = output;\n            if (!webpackStats) {\n                throw new Error('Webpack stats build result is required.');\n            }\n            let success = output.success;\n            if (success && i18n.shouldInline) {\n                outputPaths = (0, output_paths_1.ensureOutputPaths)(baseOutputPath, i18n);\n                success = await (0, i18n_inlining_1.i18nInlineEmittedFiles)(context, emittedFiles, i18n, baseOutputPath, Array.from(outputPaths.values()), [], outputPath, target <= typescript_1.ScriptTarget.ES5, options.i18nMissingTranslation);\n            }\n            (0, stats_1.webpackStatsLogger)(context.logger, webpackStats, config);\n            return { ...output, success };\n        }));\n    }), (0, operators_1.map)((output) => {\n        if (!output.success) {\n            return output;\n        }\n        return {\n            ...output,\n            baseOutputPath,\n            outputPath: baseOutputPath,\n            outputPaths: outputPaths || [baseOutputPath],\n        };\n    }));\n}\nexports.execute = execute;\nexports.default = (0, architect_1.createBuilder)(execute);\nasync function initialize(options, context, webpackConfigurationTransform) {\n    // Purge old build disk cache.\n    await (0, purge_cache_1.purgeStaleBuildCache)(context);\n    const originalOutputPath = options.outputPath;\n    const { config, i18n, target } = await (0, webpack_browser_config_1.generateI18nBrowserWebpackConfigFromContext)({\n        ...options,\n        buildOptimizer: false,\n        aot: true,\n        platform: 'server',\n    }, context, (wco) => [(0, configs_1.getCommonConfig)(wco), (0, configs_1.getStylesConfig)(wco)]);\n    let transformedConfig;\n    if (webpackConfigurationTransform) {\n        transformedConfig = await webpackConfigurationTransform(config);\n    }\n    if (options.deleteOutputPath) {\n        (0, utils_1.deleteOutputDir)(context.workspaceRoot, originalOutputPath);\n    }\n    return { config: transformedConfig || config, i18n, target };\n}\n"]},"metadata":{},"sourceType":"script"}